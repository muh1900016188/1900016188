(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Pp});var r=n("ofXK"),i=n("fXoL"),o=n("H+bZ"),s=n("tyNb"),a=n("UbJi"),u=n("D0XW"),c=n("HDdC"),h=n("Cfvw"),l=n("LRne"),f=n("JX91"),d=n("Zy1z"),p=n("lJxs"),y=n("Kqap"),g=n("/uUt"),m=n("pLZG"),v=n("pxpQ"),b=n("spgP"),w=n("Jgta"),T=n("zIRd"),I=n("mrSG"),E=n("qOnz"),O=n("q/0M"),_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function S(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var D,k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},N=k||self;function x(){}function j(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function C(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),U=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function L(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:L).apply(null,arguments)}function F(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function V(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function q(){this.s=this.s,this.o=this.o}var B={};q.prototype.s=!1,q.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++U)}(this);delete B[t]}},q.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var K=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:t>e?1:0}t:{var J=N.navigator;if(J){var Z=J.userAgent;if(Z){W=Z;break t}}W=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e={};for(var n in t)e[n]=t[n];return e}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=x;var ot,st,at=X(W,"Opera"),ut=X(W,"Trident")||X(W,"MSIE"),ct=X(W,"Edge"),ht=ct||ut,lt=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ft=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function dt(){var t=N.document;return t?t.documentMode:void 0}t:{var pt="",yt=(st=W,lt?/rv:([^\);]+)(\)|;)/.exec(st):ct?/Edge\/([\d\.]+)/.exec(st):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):ft?/WebKit\/(\S+)/.exec(st):at?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(pt=yt?yt[1]:""),ut){var gt=dt();if(null!=gt&&gt>parseFloat(pt)){ot=String(gt);break t}}ot=pt}var mt={};var vt=N.document&&ut&&(dt()||parseInt(ot,10))||void 0,bt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",x,e),N.removeEventListener("test",x,e)}catch(n){}return t}();function wt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(lt){t:{try{it(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Tt.Z.h.call(this)}}wt.prototype.h=function(){this.defaultPrevented=!0},V(Tt,wt);var It={2:"touch",3:"pen",4:"mouse"};Tt.prototype.h=function(){Tt.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Et="closure_listenable_"+(1e6*Math.random()|0),Ot=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Ot,this.ca=this.fa=!1}function St(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Dt(t){this.src=t,this.g={},this.h=0}function kt(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=K(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(St(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new _t(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),xt={};function jt(t,e,n,r,i){if(r&&r.once)return Rt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)jt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Et]?t.N(e,n,C(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=C(i)?!!i.capture:!!i,a=Ft(t);if(a||(t[Nt]=a=new Dt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Mt;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Et]?t.O(e,n,C(r)?!!r.capture:!!r,i):Ct(t,e,n,!0,r,i)}function Ut(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Ut(t,e[o],n,r,i);else r=C(r)?!!r.capture:!!r,n=qt(n),t&&t[Et]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=At(o=t.g[e],n,r,i))&&(St(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--))):t&&(t=Ft(t))&&(e=t.g[e.toString()],t=-1,e&&(t=At(e,n,r,i)),(n=-1<t?e[t]:null)&&Pt(n))}function Pt(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Et])kt(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(kt(n,t),0==n.h&&(n.src=null,e[Nt]=null)):St(t)}}}function Lt(t){return t in xt?xt[t]:xt[t]="on"+t}function Mt(t,e){if(t.ca)t=!0;else{e=new Tt(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Pt(t),t=n.call(r,e)}return t}function Ft(t){return(t=t[Nt])instanceof Dt?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(t){return"function"==typeof t?t:(t[Vt]||(t[Vt]=function(e){return t.handleEvent(e)}),t[Vt])}function Bt(){q.call(this),this.i=new Dt(this),this.P=this,this.I=null}function Kt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new wt(e,t);else if(e instanceof wt)e.target=e.target||t;else{var i=e;rt(e=new wt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Gt(s,r,!0,e)&&i}if(i=Gt(s=e.g=t,r,!0,e)&&i,i=Gt(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Gt(s=e.g=n[o],r,!1,e)&&i}function Gt(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&kt(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}V(Bt,q),Bt.prototype[Et]=!0,Bt.prototype.removeEventListener=function(t,e,n,r){Ut(this,t,e,n,r)},Bt.prototype.M=function(){if(Bt.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)St(n[r]);delete e.g[t],e.h--}}this.I=null},Bt.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Bt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var zt=N.JSON.stringify;function Qt(){var t=te,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Ht,Wt=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Yt=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,this.g=(t=this.g).next,t.next=null):t=this.i(),t},t}())(function(){return new Xt},function(t){return t.reset()}),Xt=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function $t(t){N.setTimeout(function(){throw t},0)}function Jt(t,e){Ht||function(){var t=N.Promise.resolve(void 0);Ht=function(){t.then(ee)}}(),Zt||(Ht(),Zt=!0),te.add(t,e)}var Zt=!1,te=new Wt;function ee(){for(var t;t=Qt();){try{t.h.call(t.g)}catch(n){$t(n)}var e=Yt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Zt=!1}function ne(t,e){Bt.call(this),this.h=t||1,this.g=e||N,this.j=M(this.kb,this),this.l=Date.now()}function re(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function ie(t,e,n){if("function"==typeof t)n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}function oe(t){t.g=ie(function(){t.g=null,t.i&&(t.i=!1,oe(t))},t.j);var e=t.h;t.h=null,t.m.apply(null,e)}V(ne,Bt),(D=ne.prototype).da=!1,D.S=null,D.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Kt(this,"tick"),this.da&&(re(this),this.start()))}},D.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},D.M=function(){ne.Z.M.call(this),re(this),delete this.g};var se=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:oe(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(N.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(q);function ae(t){q.call(this),this.h=t,this.g={}}V(ae,q);var ue=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=jt(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function he(t){tt(t.g,function(t,e){this.g.hasOwnProperty(e)&&Pt(t)},t),t.g={}}function le(){this.g=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.M=function(){ae.Z.M.call(this),he(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.Aa=function(){this.g=!1},le.prototype.info=function(){};var de={},pe=null;function ye(){return pe=pe||new Bt}function ge(t){wt.call(this,de.Ma,t)}function me(t){var e=ye();Kt(e,new ge(e,t))}function ve(t,e){wt.call(this,de.STAT_EVENT,t),this.stat=e}function be(t){var e=ye();Kt(e,new ve(e,t))}function we(t,e){wt.call(this,de.Na,t),this.size=e}function Te(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}de.Ma="serverreachability",V(ge,wt),de.STAT_EVENT="statevent",V(ve,wt),de.Na="timingevent",V(we,wt);var Ie={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Ee={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Oe(){}function _e(){}Oe.prototype.h=null;var Se,De={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ke(){wt.call(this,"d")}function Ae(){wt.call(this,"c")}function Ne(){}function xe(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new ae(this),this.P=Ce,this.W=new ne(t=ht?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}V(ke,wt),V(Ae,wt),V(Ne,Oe),Ne.prototype.g=function(){return new XMLHttpRequest},Ne.prototype.i=function(){return{}},Se=new Ne;var Ce=45e3,Re={},Ue={};function Pe(t,e,n){t.K=1,t.v=sn(Ze(e)),t.s=n,t.U=!0,Le(t,null)}function Le(t,e){t.F=Date.now(),qe(t),t.A=Ze(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),bn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new je,t.g=wr(t.l,n?e:null,!t.s),0<t.O&&(t.L=new se(M(t.Ia,t,t.g),t.O)),ce(t.V,t.g,"readystatechange",t.gb),e=t.H?et(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),me(1),function(t,e,n,r,i,o){t.info(function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.j,t.u,t.A,t.m,t.X,t.s)}function Me(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Fe(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Ve(t,n))==Ue){4==e&&(t.o=4,be(14),i=!1),fe(t.j,t.m,null,"[Incomplete Response]");break}if(r==Re){t.o=4,be(15),fe(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}fe(t.j,t.m,r,null),Qe(t,r)}Me(t)&&r!=Ue&&r!=Re&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,be(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),fr(e),e.L=!0,be(11))):(fe(t.j,t.m,n,"[Invalid Chunked Response]"),ze(t),Ge(t))}function Ve(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Ue:(n=Number(e.substring(n,r)),isNaN(n)?Re:(r+=1)+n>e.length?Ue:(e=e.substr(r,n),t.C=r+n,e))}function qe(t){t.Y=Date.now()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Te(M(t.eb,t),e)}function Ke(t){t.B&&(N.clearTimeout(t.B),t.B=null)}function Ge(t){0==t.l.G||t.I||yr(t.l,t)}function ze(t){Ke(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,re(t.W),he(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Qe(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Sn(n.i,t)))if(n.I=t.N,!t.J&&Sn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;pr(n),rr(n)}lr(n),be(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Te(M(n.ab,n),6e3));if(1>=_n(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else mr(n,11)}else if((t.J||n.g==t)&&pr(n),!H(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(X(h,"spdy")||X(h,"quic")||X(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Dn(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,on(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=br(r,r.H?r.la:null,r.W),d.J){kn(r.i,d);var p=d,y=r.K;y&&p.setTimeout(y),p.B&&(Ke(p),qe(p)),r.g=d}else hr(r);0<n.l.length&&sr(n)}else"stop"!=o[0]&&"close"!=o[0]||mr(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?mr(n,7):nr(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}me(4)}catch(o){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(j(t)||"string"==typeof t)G(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(j(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(j(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function We(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof We)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ye(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Xe(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Xe(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(D=xe.prototype).setTimeout=function(t){this.P=t},D.gb=function(t){t=t.target;var e=this.L;e&&3==$n(t)?e.l():this.Ia(t)},D.Ia=function(t){try{if(t==this.g)t:{var e=$n(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||ht||this.g&&(this.h.h||this.g.ga()||Jn(this.g)))){this.I||4!=e||7==n||me(8==n||0>=r?3:2),Ke(this);var i=this.g.ba();this.N=i;e:if(Me(this)){var o=Jn(this.g);t="";var s=o.length,a=4==$n(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ze(this),Ge(this);var u="";break e}this.h.i=new N.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,be(12),ze(this),Ge(this);break t}fe(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Qe(this,i)}this.U?(Fe(this,e,u),ht&&this.i&&3==e&&(ce(this.V,this.W,"tick",this.fb),this.W.start())):(fe(this.j,this.m,u,null),Qe(this,u)),4==e&&ze(this),this.i&&!this.I&&(4==e?yr(this.l,this):(this.i=!1,qe(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,be(12)):(this.o=0,be(13)),ze(this),Ge(this)}}}catch(e){}},D.fb=function(){if(this.g){var t=$n(this.g),e=this.g.ga();this.C<e.length&&(Ke(this),Fe(this,t,e),this.i&&4!=t&&qe(this))}},D.cancel=function(){this.I=!0,ze(this)},D.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(me(3),be(17)),ze(this),this.o=2,Ge(this)):Be(this,this.Y-t)},(D=We.prototype).R=function(){Ye(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},D.T=function(){return Ye(this),this.g.concat()},D.get=function(t,e){return Xe(this.h,t)?this.h[t]:e},D.set=function(t,e){Xe(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},D.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Je){this.g=void 0!==e?e:t.g,tn(this,t.j),this.s=t.s,en(this,t.i),nn(this,t.m),this.l=t.l,e=t.h;var n=new yn;n.i=e.i,e.g&&(n.g=new We(e.g),n.h=e.h),rn(this,n),this.o=t.o}else t&&(n=String(t).match($e))?(this.g=!!e,tn(this,n[1]||"",!0),this.s=an(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.l=an(n[5]||"",!0),rn(this,n[6]||"",!0),this.o=an(n[7]||"")):(this.g=!!e,this.h=new yn(null,this.g))}function Ze(t){return new Je(t)}function tn(t,e,n){t.j=n?an(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function en(t,e,n){t.i=n?an(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function rn(t,e,n){e instanceof yn?(t.h=e,function(t,e){e&&!t.j&&(gn(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},t)),t.j=e}(t.h,t.g)):(n||(e=un(e,dn)),t.h=new yn(e,t.g))}function on(t,e,n){t.h.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.j;e&&t.push(un(e,hn,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:ln,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,ln=/[#\?:]/g,fn=/[#\?]/g,dn=/[#\?@]/g,pn=/#/g;function yn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function gn(t){t.g||(t.g=new We,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function mn(t,e){gn(t),e=wn(t,e),Xe(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Xe((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Ye(t)))}function vn(t,e){return gn(t),e=wn(t,e),Xe(t.g.h,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.i=null,t.g.set(wn(t,e),Q(n)),t.h+=n.length)}function wn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(D=yn.prototype).add=function(t,e){gn(this),this.i=null,t=wn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},D.forEach=function(t,e){gn(this),this.g.forEach(function(n,r){G(n,function(n){t.call(e,n,r,this)},this)},this)},D.T=function(){gn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},D.R=function(t){gn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=z(e,this.g.get(wn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},D.set=function(t,e){return gn(this),this.i=null,vn(this,t=wn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},D.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},D.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Tn=function(){return function(t,e){this.h=t,this.g=e}}();function In(t){this.l=t||En,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.g&&N.g.Ea&&N.g.Ea()&&N.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var En=10;function On(t){return!!t.h||!!t.g&&t.g.size>=t.j}function _n(t){return t.h?1:t.g?t.g.size:0}function Sn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Dn(t,e){t.g?t.g.add(e):t.h=e}function kn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function An(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=S(t.g.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.D)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Q(t.i)}function Nn(){}function xn(){this.g=new Nn}function jn(t,e,n){var r=n||"";try{He(t,function(t,n){var i=t;C(t)&&(i=zt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(qd){throw e.push(r+"type="+encodeURIComponent("_badmap")),qd}}function Cn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}function Rn(t){this.l=t.$b||null,this.j=t.ib||!1}function Un(t,e){Bt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Pn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}In.prototype.cancel=function(){var t,e;if(this.i=An(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=S(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Nn.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return N.JSON.parse(t,void 0)},V(Rn,Oe),Rn.prototype.g=function(){return new Un(this.l,this.j)},Rn.prototype.i=function(t){return function(){return t}}({}),V(Un,Bt);var Pn=0;function Ln(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Mn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Fn(t)}function Fn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(D=Un.prototype).open=function(t,e){if(this.readyState!=Pn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Fn(this)},D.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||N).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},D.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Mn(this)),this.readyState=Pn},D.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Fn(this)),this.g&&(this.readyState=3,Fn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==N.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ln(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},D.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Mn(this):Fn(this),3==this.readyState&&Ln(this)}},D.Ua=function(t){this.g&&(this.response=this.responseText=t,Mn(this))},D.Ta=function(t){this.g&&(this.response=t,Mn(this))},D.ha=function(){this.g&&Mn(this)},D.setRequestHeader=function(t,e){this.v.append(t,e)},D.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},D.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Un.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Vn=N.JSON.parse;function qn(t){Bt.call(this),this.headers=new We,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Bn,this.K=this.L=!1}V(qn,Bt);var Bn="",Kn=/^https?$/i,Gn=["POST","PUT"];function zn(t){return"content-type"==t.toLowerCase()}function Qn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Hn(t),Yn(t)}function Hn(t){t.D||(t.D=!0,Kt(t,"complete"),Kt(t,"error"))}function Wn(t){if(t.h&&void 0!==A&&(!t.C[1]||4!=$n(t)||2!=t.ba()))if(t.v&&4==$n(t))ie(t.Fa,0,t);else if(Kt(t,"readystatechange"),4==$n(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match($e)[1]||null;if(!o&&N.self&&N.self.location){var s=N.self.location.protocol;o=s.substr(0,s.length-1)}i=!Kn.test(o?o.toLowerCase():"")}e=i}if(e)Kt(t,"complete"),Kt(t,"success");else{t.m=6;try{var a=2<$n(t)?t.g.statusText:""}catch(u){a=""}t.j=a+" ["+t.ba()+"]",Hn(t)}}finally{Yn(t)}}}function Yn(t,e){if(t.g){Xn(t);var n=t.g,r=t.C[0]?x:null;t.g=null,t.C=null,e||Kt(t,"ready");try{n.onreadystatechange=r}catch(qd){}}}function Xn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(N.clearTimeout(t.A),t.A=null)}function $n(t){return t.g?t.g.readyState:0}function Jn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Bn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return tt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function tr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function er(t){this.za=0,this.l=[],this.h=new le,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=tr("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=tr("baseRetryDelayMs",5e3,t),this.$a=tr("retryDelaySeedMs",1e4,t),this.Ya=tr("forwardChannelMaxRetries",2,t),this.ra=tr("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new In(t&&t.concurrentRequestLimit),this.Ca=new xn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function nr(t){if(ir(t),3==t.G){var e=t.V++,n=Ze(t.F);on(n,"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),ur(t,n),(e=new xe(t,t.h,e,void 0)).K=2,e.v=sn(Ze(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.v.toString(),"")),!n&&N.Image&&((new Image).src=e.v,n=!0),n||(e.g=wr(e.l,null),e.g.ea(e.v)),e.F=Date.now(),qe(e)}vr(t)}function rr(t){t.g&&(fr(t),t.g.cancel(),t.g=null)}function ir(t){rr(t),t.u&&(N.clearTimeout(t.u),t.u=null),pr(t),t.i.cancel(),t.m&&("number"==typeof t.m&&N.clearTimeout(t.m),t.m=null)}function or(t,e){t.l.push(new Tn(t.Za++,e)),3==t.G&&sr(t)}function sr(t){On(t.i)||t.m||(t.m=!0,Jt(t.Ha,t),t.C=0)}function ar(t,e){var n;n=e?e.m:t.V++;var r=Ze(t.F);on(r,"SID",t.J),on(r,"RID",n),on(r,"AID",t.U),ur(t,r),t.o&&t.s&&Zn(r,t.o,t.s),n=new xe(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=cr(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Dn(t.i,n),Pe(n,r,e)}function ur(t,e){t.j&&He({},function(t,n){on(e,n,t)})}function cr(t,e,n){n=Math.min(t.l.length,n);var r=t.j?M(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].h)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{jn(h,s,"req"+c+"_")}catch(Zr){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function hr(t){t.g||t.u||(t.Y=1,Jt(t.Ga,t),t.A=0)}function lr(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=Te(M(t.Ga,t),gr(t,t.A)),t.A++,0))}function fr(t){null!=t.B&&(N.clearTimeout(t.B),t.B=null)}function dr(t){t.g=new xe(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Ze(t.oa);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.N?"0":"1"),on(e,"AID",t.U),ur(t,e),on(e,"TYPE","xmlhttp"),t.o&&t.s&&Zn(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=sn(Ze(e)),n.s=null,n.U=!0,Le(n,t)}function pr(t){null!=t.v&&(N.clearTimeout(t.v),t.v=null)}function yr(t,e){var n=null;if(t.g==e){pr(t),fr(t),t.g=null;var r=2}else{if(!Sn(t.i,e))return;n=e.D,kn(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Kt(r=ye(),new we(r,n,e,i)),sr(t)}else hr(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(_n(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Te(M(t.Ha,t,e),gr(t,t.C)),t.C++,0)))}(t,e)||2==r&&lr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:mr(t,5);break;case 4:mr(t,10);break;case 3:mr(t,6);break;default:mr(t,2)}}function gr(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function mr(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=M(t.jb,t);n||(n=new Je("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||tn(n,"https"),sn(n)),function(t,e){var n=new le;if(N.Image){var r=new Image;r.onload=F(Cn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=F(Cn,n,r,"TestLoadImage: error",!1,e),r.onabort=F(Cn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=F(Cn,n,r,"TestLoadImage: timeout",!1,e),N.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else be(2);t.G=0,t.j&&t.j.va(e),vr(t),ir(t)}function vr(t){t.G=0,t.I=-1,t.j&&(0==An(t.i).length&&0==t.l.length||(t.i.i.length=0,Q(t.l),t.l.length=0),t.j.ua())}function br(t,e,n){var r=function(t){return t instanceof Je?Ze(t):new Je(t,void 0)}(n);if(""!=r.i)e&&en(r,e+"."+r.i),nn(r,r.m);else{var i=N.location;r=function(t,e,n,r){var i=new Je(null,void 0);return t&&tn(i,t),e&&en(i,e),n&&nn(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&tt(t.aa,function(t,e){on(r,e,t)}),n=t.sa,(e=t.D)&&n&&on(r,e,n),on(r,"VER",t.ma),ur(t,r),r}function wr(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new qn(n&&t.Ba&&!t.qa?new Rn({ib:!0}):t.qa)).L=t.H,e}function Tr(){}function Ir(){if(ut&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function Er(t,e){Bt.call(this),this.g=new er(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Sr(this)}function Or(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function _r(){Ae.call(this),this.status=1}function Sr(t){this.g=t}(D=qn.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Se.g(),this.C=function(t){return t.h||(t.h=t.i())}(this.u?this.u:Se),this.g.onreadystatechange=M(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void Qn(this,o)}t=n||"";var i=new We(this.headers);r&&He(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=zn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=N.FormData&&t instanceof N.FormData,!(0<=K(Gn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Xn(this),0<this.B&&((this.K=function(t){return ut&&function(){return t=mt,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){for(var t=0,e=Y(String(ot)).split("."),n=Y("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}();var t}()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=M(this.pa,this)):this.A=ie(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Qn(this,o)}},D.pa=function(){void 0!==A&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Kt(this,"timeout"),this.abort(8))},D.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Kt(this,"complete"),Kt(this,"abort"),Yn(this))},D.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Yn(this,!0)),qn.Z.M.call(this)},D.Fa=function(){this.s||(this.F||this.v||this.l?Wn(this):this.cb())},D.cb=function(){Wn(this)},D.ba=function(){try{return 2<$n(this)?this.g.status:-1}catch(st){return-1}},D.ga=function(){try{return this.g?this.g.responseText:""}catch(st){return""}},D.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Vn(e)}},D.Da=function(){return this.m},D.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(D=er.prototype).ma=8,D.G=1,D.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},D.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new xe(this,this.h,t,void 0),n=this.s;if(this.P&&(n?rt(n=et(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=cr(this,e,r),on(i=Ze(this.F),"RID",t),on(i,"CVER",22),this.D&&on(i,"X-HTTP-Session-Id",this.D),ur(this,i),this.o&&n&&Zn(i,this.o,n),Dn(this.i,e),this.Ra&&on(i,"TYPE","init"),this.ja?(on(i,"$req",r),on(i,"SID","null"),e.$=!0,Pe(e,i,null)):Pe(e,i,r),this.G=2}}else 3==this.G&&(t?ar(this,t):0==this.l.length||On(this.i)||ar(this))},D.Ga=function(){if(this.u=null,dr(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Te(M(this.bb,this),t)}},D.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,be(10),rr(this),dr(this))},D.ab=function(){null!=this.v&&(this.v=null,rr(this),lr(this),be(19))},D.jb=function(t){t?(this.h.info("Successfully pinged google.com"),be(2)):(this.h.info("Failed to ping google.com"),be(1))},(D=Tr.prototype).xa=function(){},D.wa=function(){},D.va=function(){},D.ua=function(){},D.Oa=function(){},Ir.prototype.g=function(t,e){return new Er(t,e)},V(Er,Bt),Er.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Jt(M(t.hb,t,e))),be(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=br(t,null,t.W),sr(t)},Er.prototype.close=function(){nr(this.g)},Er.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,or(this.g,e)}else this.v?((e={}).__data__=zt(t),or(this.g,e)):or(this.g,t)},Er.prototype.M=function(){this.g.j=null,delete this.j,nr(this.g),delete this.g,Er.Z.M.call(this)},V(Or,ke),V(_r,Ae),V(Sr,Tr),Sr.prototype.xa=function(){Kt(this.g,"a")},Sr.prototype.wa=function(t){Kt(this.g,new Or(t))},Sr.prototype.va=function(t){Kt(this.g,new _r(t))},Sr.prototype.ua=function(){Kt(this.g,"b")},Ir.prototype.createWebChannel=Ir.prototype.g,Er.prototype.send=Er.prototype.u,Er.prototype.open=Er.prototype.m,Er.prototype.close=Er.prototype.close,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Ee.COMPLETE="complete",_e.EventType=De,De.OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Bt.prototype.listen=Bt.prototype.N,qn.prototype.listenOnce=qn.prototype.O,qn.prototype.getLastError=qn.prototype.La,qn.prototype.getLastErrorCode=qn.prototype.Da,qn.prototype.getStatus=qn.prototype.ba,qn.prototype.getResponseJson=qn.prototype.Qa,qn.prototype.getResponseText=qn.prototype.ga,qn.prototype.send=qn.prototype.ea;var Dr=Ie,kr=Ee,Ar=de,Nr=Rn,xr=_e,jr=qn,Cr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Cr.o=-1;var Rr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ur=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(I.c)(e,t),e}(Error),Pr=new O.b("@firebase/firestore");function Lr(){return Pr.logLevel}function Mr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=O.a.DEBUG){var r=e.map(qr);Pr.debug.apply(Pr,Object(I.f)(["Firestore (8.8.1): "+t],r))}}function Fr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=O.a.ERROR){var r=e.map(qr);Pr.error.apply(Pr,Object(I.f)(["Firestore (8.8.1): "+t],r))}}function Vr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=O.a.WARN){var r=e.map(qr);Pr.warn.apply(Pr,Object(I.f)(["Firestore (8.8.1): "+t],r))}}function qr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(qd){return t}}function Br(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.8.1) INTERNAL ASSERTION FAILED: "+t;throw Fr(e),new Error(e)}function Kr(t,e){t||Br()}function Gr(t,e){return t}function zr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Qr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=zr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Hr(t,e){return t<e?-1:t>e?1:0}function Wr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Yr(t){return t+"\0"}var Xr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ur(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ur(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ur(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ur(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Hr(this.nanoseconds,t.nanoseconds):Hr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),$r=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Xr(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Jr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ti(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ei=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Br(),void 0===n?n=t.length-e:n>t.length-e&&Br(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ni=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(ei),ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return ri.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Ur(Rr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ur(Rr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Ur(Rr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(ei),oi=function(){function t(t){this.fields=t,t.sort(ii.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Wr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),si=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Hr(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();si.EMPTY_BYTE_STRING=new si("");var ai=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(t){if(Kr(!!t),"string"==typeof t){var e=0,n=ai.exec(t);if(Kr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ci(t.seconds),nanos:ci(t.nanos)}}function ci(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function hi(t){return"string"==typeof t?si.fromBase64String(t):si.fromUint8Array(t)}function li(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function fi(t){var e=t.mapValue.fields.__previous_value__;return li(e)?fi(e):e}function di(t){var e=ui(t.mapValue.fields.__local_write_time__.timestampValue);return new Xr(e.seconds,e.nanos)}function pi(t){return null==t}function yi(t){return 0===t&&1/t==-1/0}function gi(t){return"number"==typeof t&&Number.isInteger(t)&&!yi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var mi=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(ni.fromString(e))},t.fromName=function(e){return new t(ni.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ni.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ni.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ni(e.slice()))},t}();function vi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?li(t)?4:10:Br()}function bi(t,e){var n=vi(t);if(n!==vi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return di(t).isEqual(di(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ui(t.timestampValue),r=ui(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return hi(t.bytesValue).isEqual(hi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ci(t.geoPointValue.latitude)===ci(e.geoPointValue.latitude)&&ci(t.geoPointValue.longitude)===ci(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ci(t.integerValue)===ci(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ci(t.doubleValue),r=ci(e.doubleValue);return n===r?yi(n)===yi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Wr(t.arrayValue.values||[],e.arrayValue.values||[],bi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Jr(n)!==Jr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!bi(n[i],r[i])))return!1;return!0}(t,e);default:return Br()}}function wi(t,e){return void 0!==(t.values||[]).find(function(t){return bi(t,e)})}function Ti(t,e){var n=vi(t),r=vi(e);if(n!==r)return Hr(n,r);switch(n){case 0:return 0;case 1:return Hr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ci(t.integerValue||t.doubleValue),r=ci(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ii(t.timestampValue,e.timestampValue);case 4:return Ii(di(t),di(e));case 5:return Hr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=hi(t),r=hi(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Hr(n[i],r[i]);if(0!==o)return o}return Hr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Hr(ci(t.latitude),ci(e.latitude));return 0!==n?n:Hr(ci(t.longitude),ci(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ti(n[i],r[i]);if(o)return o}return Hr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Hr(r[s],o[s]);if(0!==a)return a;var u=Ti(n[r[s]],i[o[s]]);if(0!==u)return u}return Hr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Br()}}function Ii(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Hr(t,e);var n=ui(t),r=ui(e),i=Hr(n.seconds,r.seconds);return 0!==i?i:Hr(n.nanos,r.nanos)}function Ei(t){return Oi(t)}function Oi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ui(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?hi(t.bytesValue).toBase64():"referenceValue"in t?mi.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Oi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Oi(t.fields[o])}return e+"}"}(t.mapValue):Br();var e}function _i(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Si(t){return!!t&&"integerValue"in t}function Di(t){return!!t&&"arrayValue"in t}function ki(t){return!!t&&"nullValue"in t}function Ai(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ni(t){return!!t&&"mapValue"in t}function xi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return Zr(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=xi(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=xi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var ji=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ni(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=xi(e)},t.prototype.setAll=function(t){var e=this,n=ii.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=xi(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ni(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return bi(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ni(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){Zr(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(xi(this.value))},t}();function Ci(t){var e=[];return Zr(t.fields,function(t,n){var r=new ii([t]);if(Ni(n)){var i=Ci(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new oi(e)}var Ri=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,$r.min(),ji.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ji.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ji.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ji.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ji.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ui=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function Pi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ui(t,e,n,r,i,o,s)}function Li(t){var e=Gr(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Ei(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),pi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Xi(e.startAt)),e.endAt&&(n+="|ub:",n+=Xi(e.endAt)),e.h=n}return e.h}function Mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ji(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!bi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!to(t.startAt,e.startAt)&&to(t.endAt,e.endAt)}function Fi(t){return mi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Vi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(I.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new qi(t,n,r):"array-contains"===n?new zi(t,r):"in"===n?new Qi(t,r):"not-in"===n?new Hi(t,r):"array-contains-any"===n?new Wi(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Bi(t,n):new Ki(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Ti(e,this.value)):null!==e&&vi(this.value)===vi(e)&&this.m(Ti(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Br()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),qi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=mi.fromName(r.referenceValue),i}return Object(I.c)(e,t),e.prototype.matches=function(t){var e=mi.comparator(t.key,this.key);return this.m(e)},e}(Vi),Bi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Gi(0,n),r}return Object(I.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Vi),Ki=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Gi(0,n),r}return Object(I.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Vi);function Gi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return mi.fromName(t.referenceValue)})}var zi=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(I.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Di(e)&&wi(e.arrayValue,this.value)},e}(Vi),Qi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(I.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&wi(this.value.arrayValue,e)},e}(Vi),Hi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(I.c)(e,t),e.prototype.matches=function(t){if(wi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!wi(this.value.arrayValue,e)},e}(Vi),Wi=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(I.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Di(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return wi(e.value.arrayValue,t)})},e}(Vi),Yi=function(t,e){this.position=t,this.before=e};function Xi(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Ei(t)}).join(",")}var $i=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ji(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Zi(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?mi.comparator(mi.fromName(s.referenceValue),n.key):Ti(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function to(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!bi(t.position[n],e.position[n]))return!1;return!0}var eo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function no(t,e,n,r,i,o,s,a){return new eo(t,e,n,r,i,o,s,a)}function ro(t){return new eo(t)}function io(t){return!pi(t.limit)&&"F"===t.limitType}function oo(t){return!pi(t.limit)&&"L"===t.limitType}function so(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function ao(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function uo(t){return null!==t.collectionGroup}function co(t){var e=Gr(t);if(null===e.p){e.p=[];var n=ao(e),r=so(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new $i(n)),e.p.push(new $i(ii.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new $i(ii.keyField(),u))}}}return e.p}function ho(t){var e=Gr(t);if(!e.T)if("F"===e.limitType)e.T=Pi(e.path,e.collectionGroup,co(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=co(e);r<i.length;r++){var o=i[r];n.push(new $i(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Yi(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Yi(e.startAt.position,!e.startAt.before):null;e.T=Pi(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function lo(t,e,n){return new eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fo(t,e){return Mi(ho(t),ho(e))&&t.limitType===e.limitType}function po(t){return Li(ho(t))+"|lt:"+t.limitType}function yo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Ei(e.value);var e}).join(", ")+"]"),pi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Xi(t.startAt)),t.endAt&&(e+=", endAt: "+Xi(t.endAt)),"Target("+e+")"}(ho(t))+"; limitType="+t.limitType+")"}function go(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):mi.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Zi(t.startAt,co(t),e)||t.endAt&&Zi(t.endAt,co(t),e))}(t,e)}function mo(t){return function(e,n){for(var r=!1,i=0,o=co(t);i<o.length;i++){var s=o[i],a=vo(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function vo(t,e,n){var r=t.field.isKeyField()?mi.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ti(r,i):Br()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Br()}}function bo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yi(e)?"-0":e}}function wo(t){return{integerValue:""+t}}function To(t,e){return gi(e)?wo(e):bo(t,e)}var Io=function(){this._=void 0};function Eo(t,e,n){return t instanceof So?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Do?ko(t,e):t instanceof Ao?No(t,e):function(t,e){var n=_o(t,e),r=jo(n)+jo(t.A);return Si(n)&&Si(t.A)?wo(r):bo(t.R,r)}(t,e)}function Oo(t,e,n){return t instanceof Do?ko(t,e):t instanceof Ao?No(t,e):n}function _o(t,e){return t instanceof xo?Si(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var So=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e}(Io),Do=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(I.c)(e,t),e}(Io);function ko(t,e){for(var n=Co(e),r=function(t){n.some(function(e){return bi(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ao=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(I.c)(e,t),e}(Io);function No(t,e){for(var n=Co(e),r=function(t){n=n.filter(function(e){return!bi(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var xo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(I.c)(e,t),e}(Io);function jo(t){return ci(t.integerValue||t.doubleValue)}function Co(t){return Di(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ro=function(t,e){this.field=t,this.transform=e},Uo=function(t,e){this.version=t,this.transformResults=e},Po=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Lo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Mo=function(){};function Fo(t,e,n){t instanceof Go?function(t,e,n){var r=t.value.clone(),i=Ho(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof zo?function(t,e,n){if(Lo(t.precondition,e)){var r=Ho(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Qo(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Vo(t,e,n){t instanceof Go?function(t,e,n){if(Lo(t.precondition,e)){var r=t.value.clone(),i=Wo(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Ko(e),r).setHasLocalMutations()}}(t,e,n):t instanceof zo?function(t,e,n){if(Lo(t.precondition,e)){var r=Wo(t.fieldTransforms,n,e),i=e.data;i.setAll(Qo(t)),i.setAll(r),e.convertToFoundDocument(Ko(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Lo(t.precondition,e)&&e.convertToNoDocument($r.min())}(t,e)}function qo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=_o(o.transform,s||null);null!=a&&(null==n&&(n=ji.empty()),n.set(o.field,a))}return n||null}function Bo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Wr(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Do&&e instanceof Do||t instanceof Ao&&e instanceof Ao?Wr(t.elements,e.elements,bi):t instanceof xo&&e instanceof xo?bi(t.A,e.A):t instanceof So&&e instanceof So}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ko(t){return t.isFoundDocument()?t.version:$r.min()}var Go=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(I.c)(e,t),e}(Mo),zo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(I.c)(e,t),e}(Mo);function Qo(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function Ho(t,e,n){var r=new Map;Kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Oo(s,a,n[i]))}return r}function Wo(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Eo(a,u,e))}return r}var Yo,Xo,$o=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(I.c)(e,t),e}(Mo),Jo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(I.c)(e,t),e}(Mo),Zo=function(t){this.count=t};function ts(t){switch(t){case Rr.OK:return Br();case Rr.CANCELLED:case Rr.UNKNOWN:case Rr.DEADLINE_EXCEEDED:case Rr.RESOURCE_EXHAUSTED:case Rr.INTERNAL:case Rr.UNAVAILABLE:case Rr.UNAUTHENTICATED:return!1;case Rr.INVALID_ARGUMENT:case Rr.NOT_FOUND:case Rr.ALREADY_EXISTS:case Rr.PERMISSION_DENIED:case Rr.FAILED_PRECONDITION:case Rr.ABORTED:case Rr.OUT_OF_RANGE:case Rr.UNIMPLEMENTED:case Rr.DATA_LOSS:return!0;default:return Br()}}function es(t){if(void 0===t)return Fr("GRPC error has no .code"),Rr.UNKNOWN;switch(t){case Yo.OK:return Rr.OK;case Yo.CANCELLED:return Rr.CANCELLED;case Yo.UNKNOWN:return Rr.UNKNOWN;case Yo.DEADLINE_EXCEEDED:return Rr.DEADLINE_EXCEEDED;case Yo.RESOURCE_EXHAUSTED:return Rr.RESOURCE_EXHAUSTED;case Yo.INTERNAL:return Rr.INTERNAL;case Yo.UNAVAILABLE:return Rr.UNAVAILABLE;case Yo.UNAUTHENTICATED:return Rr.UNAUTHENTICATED;case Yo.INVALID_ARGUMENT:return Rr.INVALID_ARGUMENT;case Yo.NOT_FOUND:return Rr.NOT_FOUND;case Yo.ALREADY_EXISTS:return Rr.ALREADY_EXISTS;case Yo.PERMISSION_DENIED:return Rr.PERMISSION_DENIED;case Yo.FAILED_PRECONDITION:return Rr.FAILED_PRECONDITION;case Yo.ABORTED:return Rr.ABORTED;case Yo.OUT_OF_RANGE:return Rr.OUT_OF_RANGE;case Yo.UNIMPLEMENTED:return Rr.UNIMPLEMENTED;case Yo.DATA_LOSS:return Rr.DATA_LOSS;default:return Br()}}(Xo=Yo||(Yo={}))[Xo.OK=0]="OK",Xo[Xo.CANCELLED=1]="CANCELLED",Xo[Xo.UNKNOWN=2]="UNKNOWN",Xo[Xo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xo[Xo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xo[Xo.NOT_FOUND=5]="NOT_FOUND",Xo[Xo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xo[Xo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xo[Xo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xo[Xo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xo[Xo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xo[Xo.ABORTED=10]="ABORTED",Xo[Xo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xo[Xo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xo[Xo.INTERNAL=13]="INTERNAL",Xo[Xo.UNAVAILABLE=14]="UNAVAILABLE",Xo[Xo.DATA_LOSS=15]="DATA_LOSS";var ns=function(){function t(t,e){this.comparator=t,this.root=e||is.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,is.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,is.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new rs(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new rs(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new rs(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new rs(this.root,t,this.comparator,!0)},t}(),rs=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),is=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Br();if(this.right.isRed())throw Br();var t=this.left.check();if(t!==this.right.check())throw Br();return t+(this.isRed()?0:1)},t}();is.EMPTY=null,is.RED=!0,is.BLACK=!1,is.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Br()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new is(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var os=function(){function t(t){this.comparator=t,this.data=new ns(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ss(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ss(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ss=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),as=new ns(mi.comparator);function us(){return as}var cs=new ns(mi.comparator);function hs(){return cs}var ls=new ns(mi.comparator);function fs(){return ls}var ds=new os(mi.comparator);function ps(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ds,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ys=new os(Hr);function gs(){return ys}var ms=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,vs.createSynthesizedTargetChangeForCurrentChange(e,n)),new t($r.min(),r,gs(),us(),ps())},t}(),vs=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(si.EMPTY_BYTE_STRING,n,ps(),ps(),ps())},t}(),bs=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},ws=function(t,e){this.targetId=t,this.V=e},Ts=function(t,e,n,r){void 0===n&&(n=si.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Is=function(){function t(){this.S=0,this.D=_s(),this.C=si.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=ps(),e=ps(),n=ps();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Br()}}),new vs(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=_s()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Es=function(){function t(t){this.W=t,this.G=new Map,this.H=us(),this.J=Os(),this.Y=new os(Hr)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Br()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Fi(i))if(0===n){var o=new mi(i.path);this.tt(e,o,Ri.newNoDocument(o,$r.min()))}else Kr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&Fi(o.target)){var s=new mi(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Ri.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=ps();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new ms(t,n,this.Y,this.H,r);return this.H=us(),this.J=Os(),this.Y=new os(Hr),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Is,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new os(Hr),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Mr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Is),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Os(){return new ns(mi.comparator)}function _s(){return new ns(mi.comparator)}var Ss={asc:"ASCENDING",desc:"DESCENDING"},Ds={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ks=function(t,e){this.databaseId=t,this.I=e};function As(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ns(t,e){return t.I?e.toBase64():e.toUint8Array()}function xs(t,e){return As(t,e.toTimestamp())}function js(t){return Kr(!!t),$r.fromTimestamp(function(t){var e=ui(t);return new Xr(e.seconds,e.nanos)}(t))}function Cs(t,e){return function(t){return new ni(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Rs(t){var e=ni.fromString(t);return Kr(ia(e)),e}function Us(t,e){return Cs(t.databaseId,e.path)}function Ps(t,e){var n=Rs(e);if(n.get(1)!==t.databaseId.projectId)throw new Ur(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ur(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new mi(Vs(n))}function Ls(t,e){return Cs(t.databaseId,e)}function Ms(t){var e=Rs(t);return 4===e.length?ni.emptyPath():Vs(e)}function Fs(t){return new ni(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vs(t){return Kr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function qs(t,e,n){return{name:Us(t,e),fields:n.value.mapValue.fields}}function Bs(t,e,n){var r=Ps(t,e.name),i=js(e.updateTime),o=new ji({mapValue:{fields:e.fields}}),s=Ri.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Ks(t,e){var n;if(e instanceof Go)n={update:qs(t,e.key,e.value)};else if(e instanceof $o)n={delete:Us(t,e.key)};else if(e instanceof zo)n={update:qs(t,e.key,e.data),updateMask:ra(e.fieldMask)};else{if(!(e instanceof Jo))return Br();n={verify:Us(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof So)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Do)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ao)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof xo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Br()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:xs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Br()}(t,e.precondition)),n}function Gs(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Po.updateTime(js(t.updateTime)):void 0!==t.exists?Po.exists(t.exists):Po.none()}(e.currentDocument):Po.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Kr("REQUEST_TIME"===e.setToServerValue),n=new So):"appendMissingElements"in e?n=new Do(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Ao(e.removeAllFromArray.values||[]):"increment"in e?n=new xo(t,e.increment):Br();var r=ii.fromServerFormat(e.fieldPath);return new Ro(r,n)}(t,e)}):[];if(e.update){var i=Ps(t,e.update.name),o=new ji({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new oi((t.fieldPaths||[]).map(function(t){return ii.fromServerFormat(t)}))}(e.updateMask);return new zo(i,o,s,n,r)}return new Go(i,o,n,r)}if(e.delete){var a=Ps(t,e.delete);return new $o(a,n)}if(e.verify){var u=Ps(t,e.verify);return new Jo(u,n)}return Br()}function zs(t,e){return{documents:[Ls(t,e.path)]}}function Qs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ls(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ls(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Ai(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NAN"}};if(ki(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ai(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NOT_NAN"}};if(ki(t.value))return{unaryFilter:{field:Zs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zs(t.field),op:Js(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Zs(t.field),direction:$s(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||pi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Ys(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ys(e.endAt)),n}function Hs(t){var e=Ms(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Kr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Ws(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new $i(ta(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return pi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Xs(n.startAt));var h=null;return n.endAt&&(h=Xs(n.endAt)),no(e,i,a,s,u,"F",c,h)}function Ws(t){return t?void 0!==t.unaryFilter?[na(t)]:void 0!==t.fieldFilter?[ea(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Ws(t)}).reduce(function(t,e){return t.concat(e)}):Br():[]}function Ys(t){return{before:t.before,values:t.position}}function Xs(t){return new Yi(t.values||[],!!t.before)}function $s(t){return Ss[t]}function Js(t){return Ds[t]}function Zs(t){return{fieldPath:t.canonicalString()}}function ta(t){return ii.fromServerFormat(t.fieldPath)}function ea(t){return Vi.create(ta(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Br()}}(t.fieldFilter.op),t.fieldFilter.value)}function na(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ta(t.unaryFilter.field);return Vi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ta(t.unaryFilter.field);return Vi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ta(t.unaryFilter.field);return Vi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ta(t.unaryFilter.field);return Vi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Br()}}function ra(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function ia(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function oa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=aa(e)),e=sa(t.get(n),e);return aa(e)}function sa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function aa(t){return t+"\x01\x01"}function ua(t){var e=t.length;if(Kr(e>=2),2===e)return Kr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ni.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Br(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Br()}o=s+2}return new ni(r)}var ca=function(t,e){this.seconds=t,this.nanoseconds=e},ha=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ha.store="owner",ha.key="owner";var la=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};la.store="mutationQueues",la.keyPath="userId";var fa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};fa.store="mutations",fa.keyPath="batchId",fa.userMutationsIndex="userMutationsIndex",fa.userMutationsKeyPath=["userId","batchId"];var da=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,oa(e)]},t.key=function(t,e,n){return[t,oa(e),n]},t}();da.store="documentMutations",da.PLACEHOLDER=new da;var pa=function(t,e){this.path=t,this.readTime=e},ya=function(t,e){this.path=t,this.version=e},ga=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ga.store="remoteDocuments",ga.readTimeIndex="readTimeIndex",ga.readTimeIndexPath="readTime",ga.collectionReadTimeIndex="collectionReadTimeIndex",ga.collectionReadTimeIndexPath=["parentPath","readTime"];var ma=function(t){this.byteSize=t};ma.store="remoteDocumentGlobal",ma.key="remoteDocumentGlobalKey";var va=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};va.store="targets",va.keyPath="targetId",va.queryTargetsIndexName="queryTargetsIndex",va.queryTargetsKeyPath=["canonicalId","targetId"];var ba=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ba.store="targetDocuments",ba.keyPath=["targetId","path"],ba.documentTargetsIndex="documentTargetsIndex",ba.documentTargetsKeyPath=["path","targetId"];var wa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};wa.key="targetGlobalKey",wa.store="targetGlobal";var Ta=function(t,e){this.collectionId=t,this.parent=e};Ta.store="collectionParents",Ta.keyPath=["collectionId","parent"];var Ia=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ia.store="clientMetadata",Ia.keyPath="clientId";var Ea=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Ea.store="bundles",Ea.keyPath="bundleId";var Oa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Oa.store="namedQueries",Oa.keyPath="name";var _a=Object(I.f)(Object(I.f)([],Object(I.f)(Object(I.f)([],Object(I.f)(Object(I.f)([],Object(I.f)(Object(I.f)([],[la.store,fa.store,da.store,ga.store,va.store,ha.store,wa.store,ba.store]),[Ia.store])),[ma.store])),[Ta.store])),[Ea.store,Oa.store]),Sa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Da=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),ka=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Aa=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Br(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Na=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new ka,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Ca(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Ma(e.target.error);n.ft.reject(new Ca(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ca(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Mr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ua(e)},t}(),xa=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(E.i)())&&Fr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Mr("SimpleDb","Removing database:",t),Pa(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(E.i)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(I.b)(this,void 0,void 0,function(){var e,n=this;return Object(I.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Mr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Ca(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Ur(Rr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Ca(t,n))},i.onupgradeneeded=function(t){Mr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Mr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(I.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(I.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(I.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Na.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Aa.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Mr("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),ja=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Pa(this.Pt.delete())},t}(),Ca=function(t){function e(e,n){var r=this;return(r=t.call(this,Rr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(I.c)(e,t),e}(Ur);function Ra(t){return"IndexedDbTransactionError"===t.name}var Ua=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Mr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Mr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Pa(n)},t.prototype.add=function(t){return Mr("SimpleDb","ADD",this.store.name,t,t),Pa(this.store.add(t))},t.prototype.get=function(t){var e=this;return Pa(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Mr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Mr("SimpleDb","DELETE",this.store.name,t),Pa(this.store.delete(t))},t.prototype.count=function(){return Mr("SimpleDb","COUNT",this.store.name),Pa(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Mr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Aa(function(n,r){e.onerror=function(t){var e=Ma(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new Aa(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ja(i),s=e(i.primaryKey,i.value,o);if(s instanceof Aa){var a=s.catch(function(t){return o.done(),Aa.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Aa.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Pa(t){return new Aa(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Ma(t.target.error);n(e)}})}var La=!1;function Ma(t){var e=xa._t(Object(E.i)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ur("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return La||(La=!0,setTimeout(function(){throw r},0)),r}}return t}var Fa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(I.c)(e,t),e}(Da);function Va(t,e){var n=Gr(t);return xa.It(n.Mt,e)}var qa=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Fo(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Vo(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Vo(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument($r.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ps())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Wr(this.mutations,t.mutations,function(t,e){return Bo(t,e)})&&Wr(this.baseMutations,t.baseMutations,function(t,e){return Bo(t,e)})},t}(),Ba=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Kr(e.mutations.length===r.length);for(var i=fs(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Ka=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=$r.min()),void 0===o&&(o=$r.min()),void 0===s&&(s=si.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Ga=function(t){this.Lt=t};function za(t,e){if(e.document)return Bs(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=mi.fromSegments(e.noDocument.path),r=Xa(e.noDocument.readTime),i=Ri.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=mi.fromSegments(e.unknownDocument.path);return r=Xa(e.unknownDocument.version),Ri.newUnknownDocument(o,r)}return Br()}function Qa(t,e,n){var r=Ha(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Us(t,e.key),fields:e.data.value.mapValue.fields,updateTime:As(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new ga(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Ya(e.version);return s=e.hasCommittedMutations,new ga(null,new pa(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Ya(e.version);return new ga(new ya(c,h),null,null,!0,r,i)}return Br()}function Ha(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Wa(t){var e=new Xr(t[0],t[1]);return $r.fromTimestamp(e)}function Ya(t){var e=t.toTimestamp();return new ca(e.seconds,e.nanoseconds)}function Xa(t){var e=new Xr(t.seconds,t.nanoseconds);return $r.fromTimestamp(e)}function $a(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Gs(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return Gs(t.Lt,e)}),o=Xr.fromMillis(e.localWriteTimeMs);return new qa(e.batchId,o,n,i)}function Ja(t){var e,n,r=Xa(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Xa(t.lastLimboFreeSnapshotVersion):$r.min();return void 0!==t.query.documents?(Kr(1===(n=t.query).documents.length),e=ho(ro(Ms(n.documents[0])))):e=function(t){return ho(Hs(t))}(t.query),new Ka(e,t.targetId,0,t.lastListenSequenceNumber,r,i,si.fromBase64String(t.resumeToken))}function Za(t,e){var n,r=Ya(e.snapshotVersion),i=Ya(e.lastLimboFreeSnapshotVersion);n=Fi(e.target)?zs(t.Lt,e.target):Qs(t.Lt,e.target);var o=e.resumeToken.toBase64();return new va(e.targetId,Li(e.target),r,o,e.sequenceNumber,i,n)}function tu(t){var e=Hs({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?lo(e,e.limit,"L"):e}var eu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return nu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Xa(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return nu(t).put({bundleId:(n=e).id,createTime:Ya(js(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return ru(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:tu(e.bundledQuery),readTime:Xa(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return ru(t).put(function(t){return{name:t.name,readTime:Ya(js(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function nu(t){return Va(t,Ea.store)}function ru(t){return Va(t,Oa.store)}var iu=function(){function t(){this.Bt=new ou}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Aa.resolve()},t.prototype.getCollectionParents=function(t,e){return Aa.resolve(this.Bt.getEntries(e))},t}(),ou=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new os(ni.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new os(ni.comparator)).toArray()},t}(),su=function(){function t(){this.qt=new ou}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:oa(i)};return au(t).put(o)}return Aa.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Yr(e),""],!1,!0);return au(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ua(o.parent))}return n})},t}();function au(t){return Va(t,Ta.store)}var uu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function hu(t,e,n){var r=t.store(fa.store),i=t.store(da.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){Kr(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=da.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Aa.waitFor(o).next(function(){return c})}function lu(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Br();e=t.noDocument}return JSON.stringify(e).length}cu.DEFAULT_COLLECTION_PERCENTILE=10,cu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cu.DEFAULT=new cu(41943040,cu.DEFAULT_COLLECTION_PERCENTILE,cu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cu.DISABLED=new cu(-1,0,0);var fu=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Kr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pu(t).$t({index:fa.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=yu(t),s=pu(t);return s.add({}).next(function(a){Kr("number"==typeof a);for(var u=new qa(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Ks(t.Lt,e)}),i=n.mutations.map(function(e){return Ks(t.Lt,e)});return new fa(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new os(function(t,e){return Hr(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],y=da.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,da.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Kt[a]=u.keys()}),Aa.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return pu(t).get(e).next(function(t){return t?(Kr(t.userId===n.userId),$a(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Aa.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return pu(t).$t({index:fa.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Kr(e.batchId>=r),o=$a(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return pu(t).$t({index:fa.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return pu(t).Nt(fa.userMutationsIndex,n).next(function(t){return t.map(function(t){return $a(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=da.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return yu(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=ua(r[1]);if(a===n.userId&&e.path.isEqual(c))return pu(t).get(u).next(function(t){if(!t)throw Br();Kr(t.userId===n.userId),o.push($a(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new os(Hr),i=[];return e.forEach(function(e){var o=da.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=yu(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=ua(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),Aa.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=da.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new os(Hr);return yu(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=ua(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(pu(t).get(e).next(function(t){if(null===t)throw Br();Kr(t.userId===n.userId),r.push($a(n.R,t))}))}),Aa.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return hu(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),Aa.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Aa.resolve();var r=IDBKeyRange.lowerBound(da.prefixForUser(e.userId)),i=[];return yu(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=ua(t[1]);i.push(o)}else r.done()}).next(function(){Kr(0===i.length)})})},t.prototype.containsKey=function(t,e){return du(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return gu(t).get(this.userId).next(function(t){return t||new la(e.userId,-1,"")})},t}();function du(t,e,n){var r=da.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return yu(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function pu(t){return Va(t,fa.store)}function yu(t){return Va(t,da.store)}function gu(t){return Va(t,la.store)}var mu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),vu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new mu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return $r.fromTimestamp(new Xr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return bu(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return Kr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return bu(t).$t(function(s,a){var u=Ja(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Aa.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return bu(t).$t(function(t,n){var r=Ja(n);e(r)})},t.prototype.Xt=function(t){return wu(t).get(wa.key).next(function(t){return Kr(null!==t),t})},t.prototype.Zt=function(t,e){return wu(t).put(wa.key,e)},t.prototype.te=function(t,e){return bu(t).put(Za(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=Li(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return bu(t).$t({range:r,index:va.queryTargetsIndexName},function(t,n,r){var o=Ja(n);Mi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Tu(t);return e.forEach(function(e){var s=oa(e.path);i.push(o.put(new ba(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),Aa.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Tu(t);return Aa.forEach(e,function(e){var o=oa(e.path);return Aa.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Tu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Tu(t),i=ps();return r.$t({range:n,kt:!0},function(t,e,n){var r=ua(t[1]),o=new mi(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=oa(e.path),r=IDBKeyRange.bound([n],[Yr(n)],!1,!0),i=0;return Tu(t).$t({index:ba.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return bu(t).get(e).next(function(t){return t?Ja(t):null})},t}();function bu(t){return Va(t,va.store)}function wu(t){return Va(t,wa.store)}function Tu(t){return Va(t,ba.store)}function Iu(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){if(t.code!==Rr.FAILED_PRECONDITION||t.message!==Sa)throw t;return Mr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Eu(t,e){var n=t[1],r=e[1],i=Hr(t[0],e[0]);return 0===i?Hr(n,r):i}var Ou=function(){function t(t){this.ne=t,this.buffer=new os(Eu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Eu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),_u=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Mr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(I.b)(e,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Ra(e=n.sent())?(Mr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Iu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),Su=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Aa.resolve(Cr.o);var r=new Ou(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Mr("LruGarbageCollector","Garbage collection skipped; disabled"),Aa.resolve(uu)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Mr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),uu):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Mr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),Lr()<=O.a.DEBUG&&Mr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Aa.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Du=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Su(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return ku(t,n)},t.prototype.removeReference=function(t,e,n){return ku(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return ku(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return gu(t).Ot(function(r){return du(t,r,e).next(function(t){return t&&(n=!0),Aa.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),Tu(t).delete([0,oa(s.path)])})});i.push(u)}}).next(function(){return Aa.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return ku(t,e)},t.prototype.we=function(t,e){var n,r=Tu(t),i=Cr.o;return r.$t({index:ba.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Cr.o&&e(new mi(ua(n)),i),i=s,n=o):i=Cr.o}).next(function(){i!==Cr.o&&e(new mi(ua(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function ku(t,e){return Tu(t).put(function(t,e){return new ba(0,oa(t.path),e)}(e,t.currentSequenceNumber))}var Au=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Zr(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return ti(this.inner)},t}(),Nu=function(){function t(){this.changes=new Au(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:$r.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Ri.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Aa.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),xu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Ru(t).put(Uu(e),n)},t.prototype.removeEntry=function(t,e){var n=Ru(t),r=Uu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return Ru(t).get(Uu(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return Ru(t).get(Uu(e)).next(function(t){return{document:n.ye(e,t),size:lu(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=us();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=us(),i=new ns(mi.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,lu(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Aa.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Ru(t).$t({range:r},function(t,e,r){for(var s=mi.fromSegments(t);o&&mi.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=us(),o=e.path.length+1,s={};if(n.isEqual($r.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Ha(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=ga.collectionReadTimeIndex}return Ru(t).$t(s,function(t,n,s){if(t.length===o){var a=za(r.R,n);e.path.isPrefixOf(a.key.path)?go(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new ju(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Cu(t).get(ma.key).next(function(t){return Kr(!!t),t})},t.prototype.me=function(t,e){return Cu(t).put(ma.key,e)},t.prototype.ye=function(t,e){if(e){var n=za(this.R,e);if(!n.isNoDocument()||!n.version.isEqual($r.min()))return n}return Ri.newInvalidDocument(t)},t}(),ju=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Au(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(I.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new os(function(t,e){return Hr(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Qa(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=lu(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Qa(e.Ie.R,Ri.newNoDocument(o,$r.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),Aa.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(Nu);function Cu(t){return Va(t,ma.store)}function Ru(t){return Va(t,ga.store)}function Uu(t){return t.path.toArray()}var Pu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Kr(n<r&&n>=0&&r<=11);var o=new Na("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ha.store)}(t),function(t){t.createObjectStore(la.store,{keyPath:la.keyPath}),t.createObjectStore(fa.store,{keyPath:fa.keyPath,autoIncrement:!0}).createIndex(fa.userMutationsIndex,fa.userMutationsKeyPath,{unique:!0}),t.createObjectStore(da.store)}(t),Lu(t),function(t){t.createObjectStore(ga.store)}(t));var s=Aa.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ba.store),t.deleteObjectStore(va.store),t.deleteObjectStore(wa.store)}(t),Lu(t)),s=s.next(function(){return function(t){var e=t.store(wa.store),n=new wa(0,0,$r.min().toTimestamp(),0);return e.put(wa.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(fa.store).Nt().next(function(n){t.deleteObjectStore(fa.store),t.createObjectStore(fa.store,{keyPath:fa.keyPath,autoIncrement:!0}).createIndex(fa.userMutationsIndex,fa.userMutationsKeyPath,{unique:!0});var r=e.store(fa.store),i=n.map(function(t){return r.put(t)});return Aa.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Ia.store,{keyPath:Ia.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(ma.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ga.store);e.createIndex(ga.readTimeIndex,ga.readTimeIndexPath,{unique:!1}),e.createIndex(ga.collectionReadTimeIndex,ga.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Ea.store,{keyPath:Ea.keyPath})}(t),function(t){t.createObjectStore(Oa.store,{keyPath:Oa.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(ga.store).$t(function(t,n){e+=lu(n)}).next(function(){var n=new ma(e);return t.store(ma.store).put(ma.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(la.store),r=t.store(fa.store);return n.Nt().next(function(n){return Aa.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(fa.userMutationsIndex,i).next(function(r){return Aa.forEach(r,function(r){Kr(r.userId===n.userId);var i=$a(e.R,r);return hu(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(ba.store),n=t.store(ga.store);return t.store(wa.store).get(wa.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new ni(n),s=function(t){return[0,oa(t)]}(o);r.push(e.get(s).next(function(n){return n?Aa.resolve():function(n){return e.put(new ba(0,oa(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Aa.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(Ta.store,{keyPath:Ta.keyPath});var n=e.store(Ta.store),r=new ou,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:oa(i)})}};return e.store(ga.store).$t({kt:!0},function(t,e){var n=new ni(t);return i(n.popLast())}).next(function(){return e.store(da.store).$t({kt:!0},function(t,e){var n=ua(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(va.store);return n.$t(function(t,r){var i=Ja(r),o=Za(e.R,i);return n.put(o)})},t}();function Lu(t){t.createObjectStore(ba.store,{keyPath:ba.keyPath}).createIndex(ba.documentTargetsIndex,ba.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(va.store,{keyPath:va.keyPath}).createIndex(va.queryTargetsIndexName,va.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(wa.store)}var Mu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Fu=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Ur(Rr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Du(this,i),this.Le=n+"main",this.R=new Ga(u),this.Be=new xa(this.Le,11,new Pu(this.R)),this.qe=new vu(this.referenceDelegate,this.R),this.Ut=new su,this.Ue=function(t,e){return new xu(t,e)}(this.R,this.Ut),this.Ke=new eu,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Fr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ur(Rr.FAILED_PRECONDITION,Mu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new Cr(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(I.b)(e,void 0,void 0,function(){return Object(I.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(I.b)(e,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(I.b)(e,void 0,void 0,function(){return Object(I.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return qu(e).put(new Ia(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(Ra(e))return Mr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Mr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return Vu(t).get(ha.key).next(function(t){return Aa.resolve(e.tn(t))})},t.prototype.en=function(t){return qu(t).delete(this.clientId)},t.prototype.nn=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(I.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Va(t,Ia.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Aa.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)this.Qe.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Aa.resolve(!0):Vu(t).get(ha.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Ur(Rr.FAILED_PRECONDITION,Mu);return!1}}return!(!e.networkEnabled||!e.inForeground)||qu(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Mr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(I.b)(this,void 0,void 0,function(){var t=this;return Object(I.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[ha.store,Ia.store],function(e){var n=new Fa(e,Cr.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return qu(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return fu.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Mr("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",_a,function(o){return r=new Fa(o,i.Ne?i.Ne.next():Cr.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw Fr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new Ur(Rr.FAILED_PRECONDITION,Sa);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return Vu(t).get(ha.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ur(Rr.FAILED_PRECONDITION,Mu)})},t.prototype.Ze=function(t){var e=new ha(this.clientId,this.allowTabSynchronization,Date.now());return Vu(t).put(ha.key,e)},t.yt=function(){return xa.yt()},t.prototype.Xe=function(t){var e=this,n=Vu(t);return n.get(ha.key).next(function(t){return e.tn(t)?(Mr("IndexedDbPersistence","Releasing primary lease."),n.delete(ha.key)):Aa.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Fr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),Object(E.q)()&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Mr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Fr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Fr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Vu(t){return Va(t,ha.store)}function qu(t){return Va(t,Ia.store)}function Bu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ku=function(t,e){this.progress=t,this.wn=e},Gu=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return mi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):uo(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new mi(e)).next(function(t){var e=hs();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=hs();return this.Ut.getCollectionParents(t,i).next(function(s){return Aa.forEach(s,function(s){var a=function(t,e){return new eo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Ri.newInvalidDocument(c),r=r.insert(c,h)),Vo(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){go(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=ps(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof zo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),zu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ps(),i=ps(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Qu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual($r.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(io(e)||oo(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Lr()<=O.a.DEBUG&&Mr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),yo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new os(mo(t));return e.forEach(function(e,r){go(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Lr()<=O.a.DEBUG&&Mr("QueryEngine","Using full collection scan to execute query:",yo(e)),this.Sn.getDocumentsMatchingQuery(t,e,$r.min())},t}(),Hu=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new ns(Hr),this.kn=new Au(function(t){return Li(t)},Mi),this.$n=$r.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Gu(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function Wu(t,e,n,r){return new Hu(t,e,n,r)}function Yu(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(I.d)(this,function(s){switch(s.label){case 0:return n=Gr(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Gu(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=ps(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var y=0,g=p.mutations;y<g.length;y++)s=s.add(g[y].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function Xu(t,e){var n=Gr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Aa.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);Kr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function $u(t){var e=Gr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function Ju(t,e){var n=Gr(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Kr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=us();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(Zu(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual($r.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return Aa.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function Zu(t,e,n,r,i){var o=ps();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=us();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual($r.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Mr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function tc(t,e){var n=Gr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function ec(t,e){var n=Gr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?Aa.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new Ka(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function nc(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(I.d)(this,function(a){switch(a.label){case 0:r=Gr(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Ra(s=a.sent()))throw s;return Mr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function rc(t,e,n){var r=Gr(t),i=$r.min(),o=ps();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Gr(t),i=r.kn.get(n);return void 0!==i?Aa.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,ho(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:$r.min(),n?o:ps())}).next(function(t){return{documents:t,Bn:o}})})}function ic(t,e){var n=Gr(t),r=Gr(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function oc(t){var e=Gr(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Gr(t),i=us(),o=Ha(n),s=Ru(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:ga.readTimeIndex,range:a},function(t,e){var n=za(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:Wa(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function sc(t){return Object(I.b)(this,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){return[2,(e=Gr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Ru(t),n=$r.min();return e.$t({index:ga.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Wa(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function ac(t,e,n,r){return Object(I.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(I.d)(this,function(p){switch(p.label){case 0:for(i=Gr(t),o=ps(),s=us(),a=fs(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Kn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,ec(i,function(t){return ho(ro(ni.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return Zu(t,f,s,$r.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function uc(t,e,n){return void 0===n&&(n=ps()),Object(I.b)(this,void 0,void 0,function(){var r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:return[4,ec(t,ho(tu(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Gr(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=js(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var s=r.withResumeToken(si.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(t,e)})})]}})})}var cc=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Aa.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:js(n.createTime)}),Aa.resolve()},t.prototype.getNamedQuery=function(t,e){return Aa.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:tu(t.bundledQuery),readTime:js(t.readTime)}}(e)),Aa.resolve()},t}(),hc=function(){function t(){this.Wn=new os(lc.Gn),this.zn=new os(lc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new lc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new lc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new mi(new ni([])),r=new lc(n,t),i=new lc(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new mi(new ni([])),n=new lc(e,t),r=new lc(e,t+1),i=ps();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new lc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),lc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return mi.comparator(t.key,e.key)||Hr(t.ns,e.ns)},t.Hn=function(t,e){return Hr(t.ns,e.ns)||mi.comparator(t.key,e.key)},t}(),fc=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new os(lc.Gn)}return t.prototype.checkEmpty=function(t){return Aa.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new qa(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new lc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Aa.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Aa.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return Aa.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Aa.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Aa.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new lc(e,0),i=new lc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),Aa.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new os(Hr);return e.forEach(function(t){var e=new lc(t,0),i=new lc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),Aa.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;mi.isDocumentKey(i)||(i=i.child(""));var o=new lc(new mi(i),0),s=new os(Hr);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),Aa.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Kr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Aa.forEach(e.mutations,function(i){var o=new lc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new lc(e,0),r=this.rs.firstAfterOrEqual(n);return Aa.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return Aa.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),dc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new ns(mi.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Aa.resolve(n?n.document.clone():Ri.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=us();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Ri.newInvalidDocument(t))}),Aa.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=us(),i=new mi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||go(e,u)&&(r=r.insert(u.key,u.clone()))}return Aa.resolve(r)},t.prototype.fs=function(t,e){return Aa.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new pc(this)},t.prototype.getSize=function(t){return Aa.resolve(this.size)},t}(),pc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(I.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),Aa.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Nu),yc=function(){function t(t){this.persistence=t,this.ds=new Au(function(t){return Li(t)},Mi),this.lastRemoteSnapshotVersion=$r.min(),this.highestTargetId=0,this.ws=0,this._s=new hc,this.targetCount=0,this.ys=mu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),Aa.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Aa.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Aa.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Aa.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Aa.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new mu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Aa.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Aa.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Aa.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),Aa.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return Aa.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Aa.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Aa.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),Aa.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Aa.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Aa.resolve(n)},t.prototype.containsKey=function(t,e){return Aa.resolve(this._s.containsKey(e))},t}(),gc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Cr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new yc(this),this.Ut=new iu,this.Ue=function(t,e){return new dc(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new Ga(e),this.Ke=new cc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new fc(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Mr("MemoryPersistence","Starting transaction:",t);var i=new mc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return Aa.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),mc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(I.c)(e,t),e}(Da),vc=function(){function t(t){this.persistence=t,this.As=new hc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Br()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Aa.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Aa.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Aa.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Aa.forEach(this.vs,function(r){var i=mi.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Aa.or([function(){return Aa.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),bc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function wc(t,e){return"firestore_clients_"+t+"_"+e}function Tc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Ic(t,e){return"firestore_targets_"+t+"_"+e}bc.UNAUTHENTICATED=new bc(null),bc.GOOGLE_CREDENTIALS=new bc("google-credentials-uid"),bc.FIRST_PARTY=new bc("first-party-uid");var Ec=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Ur(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Fr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Oc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Ur(i.error.code,i.error.message)),o?new t(e,i.state,r):(Fr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),_c=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=gs(),s=0;i&&s<r.activeTargetIds.length;++s)i=gi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Fr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Sc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Fr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Dc=function(){function t(){this.activeTargetIds=gs()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),kc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new ns(Hr),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=wc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Dc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(I.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(wc(this.persistenceKey,r)))&&(o=_c.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Ic(this.persistenceKey,t));if(n){var r=Oc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Ic(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Mr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Mr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Mr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Mr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Fr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(I.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(I.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Cr.o;if(null!=t)try{var n=JSON.parse(t);Kr("number"==typeof n),e=n}catch(t){Fr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Cr.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Ec(this.currentUser,t,e,n),i=Tc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Tc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=Ic(this.persistenceKey,t),i=new Oc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return _c.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return Ec.Vs(new bc(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Oc.Vs(r,e)},t.prototype.js=function(t){return Sc.Vs(t)},t.prototype.ii=function(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Mr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=gs();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Ac=function(){function t(){this.li=new Dc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Dc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Nc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),xc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Mr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Mr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),jc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Cc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Rc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(I.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new jr;s.listenOnce(kr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Dr.NO_ERROR:var e=s.getResponseJson();Mr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Dr.TIMEOUT:Mr("Connection",'RPC "'+t+'" timed out'),o(new Ur(Rr.DEADLINE_EXCEEDED,"Request time out"));break;case Dr.HTTP_ERROR:var n=s.getStatus();if(Mr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Rr).indexOf(e)>=0?e:Rr.UNKNOWN}(r.status);o(new Ur(a,r.message))}else o(new Ur(Rr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Ur(Rr.UNAVAILABLE,"Connection failed."));break;default:Br()}}finally{Mr("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Ir,i=ye(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Nr({})),this.Fi(o.initMessageHeaders,e),Object(E.n)()||Object(E.p)()||Object(E.l)()||Object(E.m)()||Object(E.r)()||Object(E.k)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Mr("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new Cc({Ei:function(t){c?Mr("Connection","Not sending because WebChannel is closed:",t):(u||(Mr("Connection","Opening WebChannel transport."),a.open(),u=!0),Mr("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,xr.EventType.OPEN,function(){c||Mr("Connection","WebChannel transport opened.")}),l(a,xr.EventType.CLOSE,function(){c||(c=!0,Mr("Connection","WebChannel transport closed"),h.Vi())}),l(a,xr.EventType.ERROR,function(t){c||(c=!0,Vr("Connection","WebChannel transport errored:",t),h.Vi(new Ur(Rr.UNAVAILABLE,"The operation could not be completed")))}),l(a,xr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Kr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Mr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Yo[t];if(void 0!==e)return es(e)}(i),s=r.message;void 0===o&&(o=Rr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new Ur(o,s)),a.close()}else Mr("Connection","WebChannel received:",n),h.Si(n)}}),l(i,Ar.STAT_EVENT,function(t){10===t.stat?Mr("Connection","Detected buffering proxy"):11===t.stat&&Mr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Mr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Mr("RestConnection","Received: ",t),t},function(e){throw Vr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.8.1",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+jc[t]},t}());function Uc(){return"undefined"!=typeof window?window:null}function Pc(){return"undefined"!=typeof document?document:null}function Lc(t){return new ks(t,!0)}var Mc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Mr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Fc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Mc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Rr.RESOURCE_EXHAUSTED?(Fr(e.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Rr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new Ur(Rr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(I.b)(t,void 0,void 0,function(){return Object(I.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Mr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Mr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Vc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(I.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Br()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Kr(void 0===e||"string"==typeof e),si.fromBase64String(e||"")):(Kr(void 0===e||e instanceof Uint8Array),si.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Rr.UNKNOWN:es(t.code);return new Ur(e,t.message||"")}(a);n=new Ts(r,i,o,s||null)}else if("documentChange"in e){i=Ps(t,(r=e.documentChange).document.name),o=js(r.document.updateTime);var a=new ji({mapValue:{fields:r.document.fields}}),u=(s=Ri.newFoundDocument(i,o,a),r.targetIds||[]);n=new bs(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Ps(t,(r=e.documentDelete).document),o=r.readTime?js(r.readTime):$r.min(),a=Ri.newNoDocument(i,o),n=new bs([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=Ps(t,(r=e.documentRemove).document),n=new bs([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Br();var c=e.filter;i=new Zo(r=c.count||0),n=new ws(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return $r.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?$r.min():e.readTime?js(e.readTime):$r.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Fs(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Fi(r)?{documents:zs(t,r)}:{query:Qs(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Ns(t,e.resumeToken):e.snapshotVersion.compareTo($r.min())>0&&(n.readTime=As(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Br()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Fs(this.R),e.removeTarget=t,this.cr(e)},e}(Fc),qc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(I.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Kr(void 0!==e),t.map(function(t){return function(t,e){var n=js(t.updateTime?t.updateTime:e);return n.isEqual($r.min())&&(n=js(e)),new Uo(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=js(t.commitTime);return this.listener.Tr(n,e)}return Kr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Fs(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ks(e.R,t)})};this.cr(n)},e}(Fc),Bc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(I.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new Ur(Rr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Rr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ur(Rr.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Rr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ur(Rr.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),Kc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Fr(e),this.Vr=!1):Mr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Gc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(I.b)(o,void 0,void 0,function(){return Object(I.d)(this,function(t){switch(t.label){case 0:return Zc(this)?(Mr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(I.b)(this,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return(e=Gr(t)).Or.add(4),[4,Qc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,zc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new Kc(n,r)};function zc(t){return Object(I.b)(this,void 0,void 0,function(){var e,n;return Object(I.d)(this,function(r){switch(r.label){case 0:if(!Zc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Qc(t){return Object(I.b)(this,void 0,void 0,function(){var e,n;return Object(I.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Hc(t,e){var n=Gr(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Jc(n)?$c(n):ph(n).er()&&Yc(n,e))}function Wc(t,e){var n=Gr(t),r=ph(n);n.$r.delete(e),r.er()&&Xc(n,e),0===n.$r.size&&(r.er()?r.ir():Zc(n)&&n.Br.set("Unknown"))}function Yc(t,e){t.qr.U(e.targetId),ph(t).mr(e)}function Xc(t,e){t.qr.U(e),ph(t).yr(e)}function $c(t){t.qr=new Es({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),ph(t).start(),t.Br.Sr()}function Jc(t){return Zc(t)&&!ph(t).tr()&&t.$r.size>0}function Zc(t){return 0===Gr(t).Or.size}function th(t){t.qr=void 0}function eh(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){return t.$r.forEach(function(e,n){Yc(t,e)}),[2]})})}function nh(t,e){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(n){return th(t),Jc(t)?(t.Br.Nr(e),$c(t)):t.Br.set("Unknown"),[2]})})}function rh(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i,o;return Object(I.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Ts&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(I.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Mr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,ih(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof bs?t.qr.X(e):e instanceof ws?t.qr.rt(e):t.qr.et(e),n.isEqual($r.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,$u(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(si.EMPTY_BYTE_STRING,n.snapshotVersion)),Xc(t,e);var r=new Ka(n.target,e,1,n.sequenceNumber);Yc(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Mr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,ih(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function ih(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r=this;return Object(I.d)(this,function(i){switch(i.label){case 0:if(!Ra(e))throw e;return t.Or.add(1),[4,Qc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return $u(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(I.b)(r,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return Mr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,zc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function oh(t,e){return e().catch(function(n){return ih(t,n,e)})}function sh(t){return Object(I.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(I.d)(this,function(s){switch(s.label){case 0:e=Gr(t),n=yh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Zc(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,tc(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=yh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,ih(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return ah(e)&&uh(e),[2]}})})}function ah(t){return Zc(t)&&!yh(t).tr()&&t.kr.length>0}function uh(t){yh(t).start()}function ch(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){return yh(t).Ar(),[2]})})}function hh(t){return Object(I.b)(this,void 0,void 0,function(){var e,n,r;return Object(I.d)(this,function(i){for(e=yh(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function lh(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Ba.from(r,e,n),[4,oh(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,sh(t)];case 2:return o.sent(),[2]}})})}function fh(t,e){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(n){switch(n.label){case 0:return e&&yh(t).pr?[4,function(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r;return Object(I.d)(this,function(i){switch(i.label){case 0:return ts(r=e.code)&&r!==Rr.ABORTED?(n=t.kr.shift(),yh(t).sr(),[4,oh(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,sh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return ah(t)&&uh(t),[2]}})})}function dh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n;return Object(I.d)(this,function(r){switch(r.label){case 0:return n=Gr(t),e?(n.Or.delete(2),[4,zc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Qc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function ph(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Gr(t);return r.br(),new Vc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:eh.bind(null,t),Ri:nh.bind(null,t),_r:rh.bind(null,t)}),t.Mr.push(function(n){return Object(I.b)(e,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Jc(t)?$c(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),th(t),e.label=3;case 3:return[2]}})})})),t.Ur}function yh(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Gr(t);return r.br(),new qc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:ch.bind(null,t),Ri:fh.bind(null,t),Ir:hh.bind(null,t),Tr:lh.bind(null,t)}),t.Mr.push(function(n){return Object(I.b)(e,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,sh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(Mr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Kr}var gh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ka,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ur(Rr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function mh(t,e){if(Fr("AsyncQueue",e+": "+t),Ra(t))return new Ur(Rr.UNAVAILABLE,e+": "+t);throw t}var vh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||mi.comparator(e.key,n.key)}:function(t,e){return mi.comparator(t.key,e.key)},this.keyedMap=hs(),this.sortedSet=new ns(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),bh=function(){function t(){this.Qr=new ns(mi.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Br():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),wh=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,vh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&fo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Th=function(){this.Wr=void 0,this.listeners=[]},Ih=function(){this.queries=new Au(function(t){return po(t)},fo),this.onlineState="Unknown",this.Gr=new Set};function Eh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(I.d)(this,function(c){switch(c.label){case 0:if(n=Gr(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Th),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=mh(a,"Initialization of query '"+yo(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Dh(n),[2]}})})}function Oh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(I.d)(this,function(a){return n=Gr(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function _h(t,e){for(var n=Gr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Dh(n)}function Sh(t,e,n){var r=Gr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Dh(t){t.Gr.forEach(function(t){t.next()})}var kh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new wh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=wh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Ah=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Nh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Ps(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Bs(this.R,t.document,!1):Ri.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return js(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Nh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||ps()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:return[4,ac(this.localStore,new Nh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,uc(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Ku(Object.assign({},this.progress),t))]}})})}}();var xh=function(t){this.key=t},jh=function(t){this.key=t},Ch=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ps(),this.mutatedKeys=ps(),this.lo=mo(t),this.fo=new vh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new bh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=io(this.query)&&i.size===this.query.limit?i.last():null,c=oo(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=go(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),io(this.query)||oo(this.query))for(;s.size>this.query.limit;){var h=io(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Br()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new wh(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new bh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ps(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new jh(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new xh(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ps();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return wh.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Rh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Uh=function(t){this.key=t,this.bo=!1},Ph=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Au(function(t){return po(t)},fo),this.Vo=new Map,this.So=new Set,this.Do=new ns(mi.comparator),this.Co=new Map,this.No=new hc,this.xo={},this.Fo=new Map,this.ko=mu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Lh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(I.d)(this,function(a){switch(a.label){case 0:return n=fl(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,ec(n.localStore,ho(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Mh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&Hc(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Mh(t,e,n,r){return Object(I.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(I.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(I.b)(this,void 0,void 0,function(){var i,o,s;return Object(I.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,rc(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,($h(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,rc(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Ch(e,i.Bn),s=o._o(i.documents),a=vs.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),$h(t,n,u.To),c=new Rh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Fh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:return n=Gr(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!fo(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,nc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),Wc(n.remoteStore,r.targetId),Yh(n,r.targetId)}).catch(Iu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Yh(n,r.targetId),[4,nc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Vh(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(I.d)(this,function(a){switch(a.label){case 0:r=dl(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Gr(t),i=Xr.now(),o=e.reduce(function(t,e){return t.add(e.key)},ps());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=qo(c,n.get(c.key));null!=h&&s.push(new zo(c.key,h,Ci(h.value.mapValue),Po.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new ns(Hr)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,tl(r,i.changes)];case 3:return a.sent(),[4,sh(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=mh(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function qh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r;return Object(I.d)(this,function(i){switch(i.label){case 0:n=Gr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Ju(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(Kr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Kr(r.bo):t.removedDocuments.size>0&&(Kr(r.bo),r.bo=!1))}),[4,tl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Iu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Bh(t,e,n){var r=Gr(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Gr(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Dh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Kh(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(I.d)(this,function(c){switch(c.label){case 0:return(r=Gr(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new ns(mi.comparator)).insert(o,Ri.newNoDocument(o,$r.min())),a=ps().add(o),u=new ms($r.min(),new Map,new os(Hr),s,a),[4,qh(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Zh(r),[3,4];case 2:return[4,nc(r.localStore,e,!1).then(function(){return Yh(r,e,n)}).catch(Iu)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Gh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:n=Gr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Xu(n.localStore,e)];case 2:return i=o.sent(),Wh(n,r,null),Hh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,tl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Iu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function zh(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:r=Gr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Gr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return Kr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),Wh(r,e,n),Hh(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,tl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Iu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Qh(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(I.d)(this,function(a){switch(a.label){case 0:Zc((n=Gr(t)).remoteStore)||Mr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Gr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=mh(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function Hh(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function Wh(t,e,n){var r=Gr(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Yh(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||Xh(t,e)})}function Xh(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Wc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Zh(t))}function $h(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof xh?(t.No.addReference(o.key,e),Jh(t,o)):o instanceof jh?(Mr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Xh(t,o.key)):Br()}}function Jh(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Mr("SyncEngine","New document in limbo: "+n),t.So.add(r),Zh(t))}function Zh(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new mi(ni.fromString(e)),r=t.ko.next();t.Co.set(r,new Uh(n)),t.Do=t.Do.insert(n,r),Hc(t.remoteStore,new Ka(ho(ro(n.path)),r,2,Cr.o))}}function tl(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(I.d)(this,function(a){switch(a.label){case 0:return r=Gr(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=zu.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(I.d)(this,function(h){switch(h.label){case 0:n=Gr(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Aa.forEach(e,function(e){return Aa.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return Aa.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Ra(r=h.sent()))throw r;return Mr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function el(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r;return Object(I.d)(this,function(i){switch(i.label){case 0:return(n=Gr(t)).currentUser.isEqual(e)?[3,3]:(Mr("SyncEngine","User change. New user:",e.toKey()),[4,Yu(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new Ur(Rr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,tl(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function nl(t,e){var n=Gr(t),r=n.Co.get(e);if(r&&r.bo)return ps().add(r.key);var i=ps(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function rl(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:return[4,rc((n=Gr(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&$h(n,e.targetId,i.To),i)]}})})}function il(t){return Object(I.b)(this,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){return[2,oc((e=Gr(t)).localStore).then(function(t){return tl(e,t)})]})})}function ol(t,e,n,r){return Object(I.b)(this,void 0,void 0,function(){var i,o;return Object(I.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Gr(t),r=Gr(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):Aa.resolve(null)})})}((i=Gr(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,sh(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Wh(i,e,r||null),Hh(i,e),function(t,e){Gr(Gr(t)._n).Gt(e)}(i.localStore,e)):Br(),s.label=4;case 4:return[4,tl(i,o)];case 5:return s.sent(),[3,7];case 6:Mr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function sl(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(I.d)(this,function(c){switch(c.label){case 0:return fl(n=Gr(t)),dl(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,al(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,dh(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Hc(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return Yh(n,e),nc(n.localStore,e,!0)}),Wc(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,al(n,a)];case 5:return c.sent(),function(t){var e=Gr(t);e.Co.forEach(function(t,n){Wc(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new ns(mi.comparator)}(n),n.$o=!1,[4,dh(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function al(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(I.d)(this,function(y){switch(y.label){case 0:n=Gr(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,ec(n.localStore,ho(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),h=0,l=c,y.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,rl(n,f)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,ic(n.localStore,a)];case 8:return p=y.sent(),[4,ec(n.localStore,p)];case 9:return u=y.sent(),[4,Mh(n,ul(p),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function ul(t){return no(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function cl(t){var e=Gr(t);return Gr(Gr(e.localStore).persistence).fn()}function hl(t,e,n,r){return Object(I.b)(this,void 0,void 0,function(){var i,o,s;return Object(I.d)(this,function(a){switch(a.label){case 0:return(i=Gr(t)).$o?(Mr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,oc(i.localStore)];case 3:return o=a.sent(),s=ms.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,tl(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,nc(i.localStore,e,!0)];case 6:return a.sent(),Yh(i,e,r),[3,8];case 7:Br(),a.label=8;case 8:return[2]}})})}function ll(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(I.d)(this,function(f){switch(f.label){case 0:if(!(r=fl(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Mr("SyncEngine","Adding an already active target "+s),[3,5]):[4,ic(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,ec(r.localStore,a)];case 3:return u=f.sent(),[4,Mh(r,ul(a),u.targetId,!1)];case 4:f.sent(),Hc(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(I.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,nc(r.localStore,t,!1).then(function(){Wc(r.remoteStore,t),Yh(r,t)}).catch(Iu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function fl(t){var e=Gr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=qh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Kh.bind(null,e),e.vo._r=_h.bind(null,e.eventManager),e.vo.Mo=Sh.bind(null,e.eventManager),e}function dl(t){var e=Gr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gh.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zh.bind(null,e),e}var pl=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return this.R=Lc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Wu(this.persistence,new Qu,t.initialUser,this.R)},t.prototype.qo=function(t){return new gc(vc.bs,this.R)},t.prototype.Bo=function(t){return new Ac},t.prototype.terminate=function(){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),yl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(I.c)(e,t),e.prototype.initialize=function(e){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,sc(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,dl(this.Qo.syncEngine)];case 4:return n.sent(),[4,sh(this.Qo.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Ko=function(t){return Wu(this.persistence,new Qu,t.initialUser,this.R)},e.prototype.Uo=function(t){return new _u(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=Bu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?cu.withCacheSize(this.cacheSizeBytes):cu.DEFAULT;return new Fu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Uc(),Pc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Ac},e}(pl),gl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(I.c)(e,t),e.prototype.initialize=function(e){return Object(I.b)(this,void 0,void 0,function(){var n,r=this;return Object(I.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof kc?(this.sharedClientState.syncEngine={ui:ol.bind(null,n),ai:hl.bind(null,n),hi:ll.bind(null,n),fn:cl.bind(null,n),ci:il.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(I.b)(r,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return[4,sl(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=Uc();if(!kc.yt(e))throw new Ur(Rr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Bu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new kc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(yl),ml=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(I.b)(this,void 0,void 0,function(){var n=this;return Object(I.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Bh(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=el.bind(null,this.syncEngine),[4,dh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new Ih},t.prototype.createDatastore=function(t){var e=Lc(t.databaseInfo.databaseId),n=new Rc(t.databaseInfo);return function(t,e,n){return new Bc(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Bh(s.syncEngine,t,0)},o=xc.yt()?new xc:new Nc,new Gc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Ph(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(I.b)(this,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return e=Gr(t),Mr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Qc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),vl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),bl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new ka,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(I.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Ah(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e;return Object(I.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(I.b)(this,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e;return Object(I.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(I.b)(this,void 0,void 0,function(){var e,n=this;return Object(I.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Ur(Rr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(I.d)(this,function(u){switch(u.label){case 0:return n=Gr(t),r=Fs(n.R)+"/documents",i={documents:e.map(function(t){return Us(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Kr(!!e.found);var n=Ps(t,e.found.name),r=js(e.found.updateTime),i=new ji({mapValue:{fields:e.found.fields}});return Ri.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Kr(!!e.missing),Kr(!!e.readTime);var n=Ps(t,e.missing),r=js(e.readTime);return Ri.newNoDocument(n,r)}(t,e):Br()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Kr(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new $o(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e=this;return Object(I.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=mi.fromPath(n);e.mutations.push(new Jo(r,e.precondition(r)))}),[4,function(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:return n=Gr(t),r=Fs(n.R)+"/documents",i={writes:e.map(function(t){return Ks(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Br();e=$r.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ur(Rr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Po.updateTime(e):Po.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual($r.min()))throw new Ur(Rr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Po.updateTime(e)}return Po.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),wl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Mc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(I.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(I.d)(this,function(r){return t=new bl(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!pi(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ts(e)}return!1},t}(),Tl=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=bc.UNAUTHENTICATED,this.clientId=Qr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(I.b)(r,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return Mr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Ur(Rr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new ka;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(I.b)(t,void 0,void 0,function(){var t,n;return Object(I.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=mh(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Il(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(I.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Mr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(I.b)(i,void 0,void 0,function(){return Object(I.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Yu(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function El(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r;return Object(I.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Ol(t)];case 1:return n=i.sent(),Mr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(I.b)(this,void 0,void 0,function(){var n,r;return Object(I.d)(this,function(i){switch(i.label){case 0:return(n=Gr(t)).asyncQueue.verifyOperationInProgress(),Mr("RemoteStore","RemoteStore received new credentials"),r=Zc(n),n.Or.add(3),[4,Qc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,zc(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function Ol(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Mr("FirestoreClient","Using default OfflineComponentProvider"),[4,Il(t,new pl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function _l(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Mr("FirestoreClient","Using default OnlineComponentProvider"),[4,El(t,new ml)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function Sl(t){return Ol(t).then(function(t){return t.persistence})}function Dl(t){return Ol(t).then(function(t){return t.localStore})}function kl(t){return _l(t).then(function(t){return t.remoteStore})}function Al(t){return _l(t).then(function(t){return t.syncEngine})}function Nl(t){return Object(I.b)(this,void 0,void 0,function(){var e,n;return Object(I.d)(this,function(r){switch(r.label){case 0:return[4,_l(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Lh.bind(null,e.syncEngine),n.onUnlisten=Fh.bind(null,e.syncEngine),n)]}})})}function xl(t,e,n){var r=this;void 0===n&&(n={});var i=new ka;return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(r,void 0,void 0,function(){var r;return Object(I.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new vl({next:function(o){e.enqueueAndForget(function(){return Oh(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Ur(Rr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Ur(Rr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new kh(ro(n.path),o,{includeMetadataChanges:!0,so:!0});return Eh(t,s)},[4,Nl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function jl(t,e,n){var r=this;void 0===n&&(n={});var i=new ka;return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(r,void 0,void 0,function(){var r;return Object(I.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new vl({next:function(n){e.enqueueAndForget(function(){return Oh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Ur(Rr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new kh(n,o,{includeMetadataChanges:!0,so:!0});return Eh(t,s)},[4,Nl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var Cl=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Rl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Ul=new Map,Pl=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Ll=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(bc.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ml=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Fl=function(){function t(t){var e=this;this.currentUser=bc.UNAUTHENTICATED,this.oc=new ka,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Mr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Mr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Mr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Kr("string"==typeof n.accessToken),new Pl(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(I.b)(n,void 0,void 0,function(){return Object(I.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Kr(null===t||"string"==typeof t),new bc(t)},t}(),Vl=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=bc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),ql=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Vl(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(bc.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Bl(t,e,n){if(!n)throw new Ur(Rr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Kl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Gl(t,e,n,r){if(!0===e&&!0===r)throw new Ur(Rr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function zl(t){if(!mi.isDocumentKey(t))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Ql(t){if(mi.isDocumentKey(t))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Hl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Br()}function Wl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ur(Rr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Hl(t);throw new Ur(Rr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Yl(t,e){if(e<=0)throw new Ur(Rr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Xl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ur(Rr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ur(Rr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Gl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),$l=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xl({}),this._settingsFrozen=!1,t instanceof Rl?(this._databaseId=t,this._credentials=new Ll):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ur(Rr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rl(t.options.projectId)}(t),this._credentials=new Fl(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Ur(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Ur(Rr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xl(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Ll;switch(t.type){case"gapi":var e=t.client;return Kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ql(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ur(Rr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Ul.get(this))&&(Mr("ComponentProvider","Removing Datastore"),Ul.delete(this),t.terminate()),Promise.resolve();var t},t}(),Jl=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new tf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Zl=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),tf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ro(r))||this)._path=r,i.type="collection",i}return Object(I.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Jl(this.firestore,null,new mi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Zl);function ef(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(E.h)(t),Bl("collection","path",e),t instanceof $l)return Ql(n=ni.fromString.apply(ni,Object(I.f)([e],r))),new tf(t,null,n);if(!(t instanceof Jl||t instanceof tf))throw new Ur(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ql(n=ni.fromString.apply(ni,Object(I.f)([t.path],r)).child(ni.fromString(e))),new tf(t.firestore,null,n)}function nf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(E.h)(t),1===arguments.length&&(e=Qr.u()),Bl("doc","path",e),t instanceof $l)return zl(n=ni.fromString.apply(ni,Object(I.f)([e],r))),new Jl(t,null,new mi(n));if(!(t instanceof Jl||t instanceof tf))throw new Ur(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return zl(n=t._path.child(ni.fromString.apply(ni,Object(I.f)([e],r)))),new Jl(t.firestore,t instanceof tf?t.converter:null,new mi(n))}function rf(t,e){return t=Object(E.h)(t),e=Object(E.h)(e),(t instanceof Jl||t instanceof tf)&&(e instanceof Jl||e instanceof tf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function of(t,e){return t=Object(E.h)(t),e=Object(E.h)(e),t instanceof Zl&&e instanceof Zl&&t.firestore===e.firestore&&fo(t._query,e._query)&&t.converter===e.converter}var sf=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Mc(this,"async_queue_retry"),this.Ic=function(){var e=Pc();e&&Mr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Pc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Pc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise(function(){});var n=new ka;return this.Rc(function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.bc()})},t.prototype.bc=function(){return Object(I.b)(this,void 0,void 0,function(){var t,e=this;return Object(I.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ra(t=n.sent()))throw t;return Mr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.bc()}),n.label=5;case 5:return[2]}})})},t.prototype.Rc=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,Fr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=gh.createAndSchedule(this,t,e,n,function(t){return r.vc(t)});return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Br()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return Object(I.b)(this,void 0,void 0,function(){var t;return Object(I.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()})},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function af(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new ka,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var uf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new sf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(I.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||hf(this),this._firestoreClient.terminate()},e}($l);function cf(t){return t._firestoreClient||hf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function hf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Cl(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Tl(t._credentials,t._queue,r)}function lf(t,e,n){var r=this,i=new ka;return t.asyncQueue.enqueue(function(){return Object(I.b)(r,void 0,void 0,function(){var r;return Object(I.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Il(t,n)];case 1:return o.sent(),[4,El(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Rr.FAILED_PRECONDITION||t.code===Rr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function ff(t){if(t._initialized||t._terminated)throw new Ur(Rr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var df=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ii(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),pf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(si.fromBase64String(e))}catch(e){throw new Ur(Rr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(si.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),yf=function(t){this._methodName=t},gf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ur(Rr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ur(Rr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Hr(this._lat,t._lat)||Hr(this._long,t._long)},t}(),mf=/^__.*__$/,vf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new zo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Go(t,this.data,e,this.fieldTransforms)},t}(),bf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new zo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function wf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Br()}}var Tf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.Fc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,kc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,kc:!0})},t.prototype.Lc=function(t){return qf(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(wf(this.Nc)&&mf.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),If=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Lc(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new Tf({Nc:t,methodName:e,qc:n,path:ii.emptyPath(),kc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Ef(t){var e=t._freezeSettings(),n=Lc(t._databaseId);return new If(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Of(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Lf("Data must be an object, but it was:",s,r);var a,u,c=Uf(r,s);if(o.merge)a=new oi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Mf(e,f[l],n);if(!s.contains(d))throw new Ur(Rr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Bf(h,d)||h.push(d)}a=new oi(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new vf(new ji(c),a,u)}var _f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw t.Lc(1===t.Nc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(yf);function Sf(t,e,n){return new Tf({Nc:3,qc:e.settings.qc,methodName:t._methodName,kc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Df=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e.prototype._toFieldTransform=function(t){return new Ro(t.path,new So)},e.prototype.isEqual=function(t){return t instanceof e},e}(yf),kf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(I.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Sf(this,t,!0),n=this.Kc.map(function(t){return Rf(t,e)}),r=new Do(n);return new Ro(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(yf),Af=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(I.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Sf(this,t,!0),n=this.Kc.map(function(t){return Rf(t,e)}),r=new Ao(n);return new Ro(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(yf),Nf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Object(I.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new xo(t.R,To(t.R,this.Qc));return new Ro(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(yf);function xf(t,e,n,r){var i=t.Uc(1,e,n);Lf("Data must be an object, but it was:",i,r);var o=[],s=ji.empty();Zr(r,function(t,r){var a=Vf(e,t,n);r=Object(E.h)(r);var u=i.Oc(a);if(r instanceof _f)o.push(a);else{var c=Rf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new oi(o);return new bf(s,a,i.fieldTransforms)}function jf(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[Mf(e,r,n)],u=[i];if(o.length%2!=0)throw new Ur(Rr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Mf(e,o[c])),u.push(o[c+1]);for(var h=[],l=ji.empty(),f=a.length-1;f>=0;--f)if(!Bf(h,a[f])){var d=a[f],p=u[f];p=Object(E.h)(p);var y=s.Oc(d);if(p instanceof _f)h.push(d);else{var g=Rf(p,y);null!=g&&(h.push(d),l.set(d,g))}}var m=new oi(h);return new bf(l,m,s.fieldTransforms)}function Cf(t,e,n,r){return void 0===r&&(r=!1),Rf(n,t.Uc(r?4:3,e))}function Rf(t,e){if(Pf(t=Object(E.h)(t)))return Lf("Unsupported field value:",e,t),Uf(t,e);if(t instanceof yf)return function(t,e){if(!wf(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.kc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Rf(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(E.h)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return To(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Xr.fromDate(t);return{timestampValue:As(e.R,n)}}if(t instanceof Xr)return n=new Xr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:As(e.R,n)};if(t instanceof gf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof pf)return{bytesValue:Ns(e.R,t._byteString)};if(t instanceof Jl){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Cs(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Hl(t))}(t,e)}function Uf(t,e){var n={};return ti(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zr(t,function(t,r){var i=Rf(r,e.Fc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Pf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Xr||t instanceof gf||t instanceof pf||t instanceof Jl||t instanceof yf)}function Lf(t,e,n){if(!Pf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Hl(n);throw e.Lc("an object"===r?t+" a custom object":t+" "+r)}}function Mf(t,e,n){if((e=Object(E.h)(e))instanceof df)return e._internalPath;if("string"==typeof e)return Vf(t,e);throw qf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ff=new RegExp("[~\\*/\\[\\]]");function Vf(t,e,n){if(e.search(Ff)>=0)throw qf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(df.bind.apply(df,Object(I.f)([void 0],e.split(".")))))._internalPath}catch(qd){throw qf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function qf(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Ur(Rr.INVALID_ARGUMENT,(a+=". ")+t+u)}function Bf(t,e){return t.some(function(t){return t.isEqual(e)})}var Kf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Jl(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Gf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(zf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Kf);function zf(t,e){return"string"==typeof e?Vf(t,e):e instanceof df?e._internalPath:e._delegate._internalPath}var Qf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Hf=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(I.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Wf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(zf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Kf),Wf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Hf),Yf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Qf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new Wf(n._firestore,n._userDataWriter,r.key,r,new Qf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ur(Rr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new Wf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Qf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Wf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Qf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Xf(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Xf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Br()}}function $f(t,e){return t instanceof Hf&&e instanceof Hf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Yf&&e instanceof Yf&&t._firestore===e._firestore&&of(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Jf(t){if(oo(t)&&0===t.explicitOrderBy.length)throw new Ur(Rr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zf=function(){};function td(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var ed=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return Object(I.c)(e,t),e.prototype._apply=function(t){var e=Ef(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ud(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(ad(r,t,h[c]));a={arrayValue:{values:u}}}else a=ad(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ud(s,o),a=Cf(n,"where",s,"in"===o||"not-in"===o);var l=Vi.create(i,o,a);return function(t,e){if(e.g()){var n=ao(t);if(null!==n&&!n.isEqual(e.field))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=so(t);null!==r&&cd(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Ur(Rr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Zl(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Zf),nd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return Object(I.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new $i(e,n);return function(t,e){if(null===so(t)){var n=ao(t);null!==n&&cd(0,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new Zl(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new eo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Zf),rd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return Object(I.c)(e,t),e.prototype._apply=function(t){return new Zl(t.firestore,t.converter,lo(t._query,this.Hc,this.Jc))},e}(Zf),id=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Object(I.c)(e,t),e.prototype._apply=function(t){var e=sd(t,this.type,this.Yc,this.Xc);return new Zl(t.firestore,t.converter,function(t,e){return new eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Zf),od=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Object(I.c)(e,t),e.prototype._apply=function(t){var e=sd(t,this.type,this.Yc,this.Xc);return new Zl(t.firestore,t.converter,function(t,e){return new eo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Zf);function sd(t,e,n,r){if(n[0]=Object(E.h)(n[0]),n[0]instanceof Kf)return function(t,e,n,r,i){if(!r)throw new Ur(Rr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=co(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(_i(e,r.key));else{var c=r.data.field(u.field);if(li(c))throw new Ur(Rr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Yi(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Ef(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Ur(Rr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!uo(t)&&-1!==c.indexOf("/"))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ni.fromString(c));if(!mi.isDocumentKey(h))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new mi(h);a.push(_i(e,l))}else{var f=Cf(n,r,c);a.push(f)}}return new Yi(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function ad(t,e,n){if("string"==typeof(n=Object(E.h)(n))){if(""===n)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!uo(e)&&-1!==n.indexOf("/"))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ni.fromString(n));if(!mi.isDocumentKey(r))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return _i(t,new mi(r))}if(n instanceof Jl)return _i(t,n._key);throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Hl(n)+".")}function ud(t,e){if(!Array.isArray(t)||0===t.length)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function cd(t,e,n){if(!n.isEqual(e))throw new Ur(Rr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var hd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),vi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ci(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(hi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Br()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Zr(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new gf(ci(t.latitude),ci(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=fi(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(di(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ui(t);return new Xr(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=ni.fromString(t);Kr(ia(n));var r=new Rl(n.get(1),n.get(3)),i=new mi(n.popFirst(5));return r.isEqual(e)||Fr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function ld(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var fd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(I.c)(e,t),e.prototype.convertBytes=function(t){return new pf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Jl(this.firestore,null,e)},e}(hd),dd=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Ef(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=pd(t,this._firestore),i=ld(r.converter,e,n),o=Of(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Po.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=pd(t,this._firestore);return o="string"==typeof(e=Object(E.h)(e))||e instanceof df?jf(this._dataReader,"WriteBatch.update",s._key,e,n,r):xf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Po.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=pd(t,this._firestore);return this._mutations=this._mutations.concat(new $o(e._key,Po.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Ur(Rr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function pd(t,e){if((t=Object(E.h)(t)).firestore!==e)throw new Ur(Rr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var yd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(I.c)(e,t),e.prototype.convertBytes=function(t){return new pf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Jl(this.firestore,null,e)},e}(hd);function gd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Wl(t,Jl);var o=Wl(t.firestore,uf),s=Ef(o);return vd(o,[("string"==typeof(e=Object(E.h)(e))||e instanceof df?jf(s,"updateDoc",t._key,e,n,r):xf(s,"updateDoc",t._key,e)).toMutation(t._key,Po.exists(!0))])}function md(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(E.h)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||af(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(af(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Jl)c=Wl(t.firestore,uf),h=ro(t._key.path),u={next:function(e){i[a]&&i[a](bd(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=Wl(t,Zl);c=Wl(d.firestore,uf),h=d._query;var p=new yd(c);u={next:function(t){i[a]&&i[a](new Yf(c,p,d,t))},error:i[a+1],complete:i[a+2]},Jf(t._query)}return function(t,e,n,r){var i=this,o=new vl(r),s=new kh(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(i,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return e=Eh,[4,Nl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(i,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return e=Oh,[4,Nl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(cf(c),h,l,u)}function vd(t,e){return function(t,e){var n=this,r=new ka;return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(n,void 0,void 0,function(){var n;return Object(I.d)(this,function(i){switch(i.label){case 0:return n=Vh,[4,Al(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(cf(t),e)}function bd(t,e,n){var r=n.docs.get(e._key),i=new yd(t);return new Hf(t,i,e._key,r,new Qf(n.hasPendingWrites,n.fromCache),e.converter)}var wd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(I.c)(e,t),e.prototype.get=function(e){var n=this,r=pd(e,this._firestore),i=new yd(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new Hf(n._firestore,i,r._key,t._document,new Qf(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Ef(t)}return t.prototype.get=function(t){var e=this,n=pd(t,this._firestore),r=new fd(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Br();var i=t[0];if(i.isFoundDocument())return new Kf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Kf(e._firestore,r,n._key,null,n.converter);throw Br()})},t.prototype.set=function(t,e,n){var r=pd(t,this._firestore),i=ld(r.converter,e,n),o=Of(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=pd(t,this._firestore);return o="string"==typeof(e=Object(E.h)(e))||e instanceof df?jf(this._dataReader,"Transaction.update",s._key,e,n,r):xf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=pd(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Td(){if("undefined"==typeof Uint8Array)throw new Ur(Rr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Id(){if("undefined"==typeof atob)throw new Ur(Rr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ed=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Id(),new t(pf.fromBase64String(e))},t.fromUint8Array=function(e){return Td(),new t(pf.fromUint8Array(e))},t.prototype.toBase64=function(){return Id(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Td(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Od=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ff(t=Wl(t,uf));var n=cf(t),r=t._freezeSettings(),i=new ml;return lf(n,i,new yl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ff(t=Wl(t,uf));var e=cf(t),n=t._freezeSettings(),r=new ml;return lf(e,r,new gl(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Ur(Rr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new ka;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(I.b)(e,void 0,void 0,function(){var e;return Object(I.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(I.b)(this,void 0,void 0,function(){return Object(I.d)(this,function(e){switch(e.label){case 0:return xa.yt()?[4,xa.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Bu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),_d=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Rl||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Vr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=Wl(t,$l))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Vr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(E.d)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Ur(Rr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Ml(new Pl(o,new bc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(I.b)(e,void 0,void 0,function(){var e,n;return Object(I.d)(this,function(r){switch(r.label){case 0:return[4,Sl(t)];case 1:return e=r.sent(),[4,kl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Gr(t);return e.Or.delete(0),zc(e)}(n))]}})})})}(cf(Wl(this._delegate,uf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(I.b)(e,void 0,void 0,function(){var e,n;return Object(I.d)(this,function(r){switch(r.label){case 0:return[4,Sl(t)];case 1:return e=r.sent(),[4,kl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(I.b)(this,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return(e=Gr(t)).Or.add(0),[4,Qc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(cf(Wl(this._delegate,uf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Gl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new ka;return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(e,void 0,void 0,function(){var e;return Object(I.d)(this,function(r){switch(r.label){case 0:return e=Qh,[4,Al(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(cf(Wl(this._delegate,uf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new vl(e);return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(n,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Gr(t).Gr.add(e),e.next()},[4,Nl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(n,void 0,void 0,function(){var e;return Object(I.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Gr(t).Gr.delete(e)},[4,Nl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(cf(t=Wl(t,uf)),af(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new Ur(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Fd(this,ef(this._delegate,t))}catch(t){throw xd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Nd(this,nf(this._delegate,t))}catch(t){throw xd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Pd(this,function(t,e){if(t=Wl(t,$l),Bl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Zl(t,null,function(t){return new eo(ni.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw xd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new ka;return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(n,void 0,void 0,function(){var n;return Object(I.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return _l(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new wl(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(cf(t),function(n){return e(new wd(t,n))})}(this._delegate,function(n){return t(new Dd(e,n))})},t.prototype.batch=function(){var t=this;return cf(this._delegate),new kd(new dd(this._delegate,function(e){return vd(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new Ur(Rr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Ur(Rr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Sd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(I.c)(e,t),e.prototype.convertBytes=function(t){return new Ed(new pf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Nd.eu(e,this.firestore,null)},e}(hd),Dd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Sd(t)}return t.prototype.get=function(t){var e=this,n=Vd(t);return this._delegate.get(n).then(function(t){return new Rd(e._firestore,new Hf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=Vd(t);return n?(Kl("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Vd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(I.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Vd(t);return this._delegate.delete(e),this},t}(),kd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Vd(t);return n?(Kl("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Vd(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(I.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Vd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Ad=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Wf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Ud(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Sd(e),n),i.set(n,o)),o},t}();Ad.su=new WeakMap;var Nd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Sd(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new Ur(Rr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Jl(n._delegate,r,new mi(e)))},t.eu=function(e,n,r){return new t(n,new Jl(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Fd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Fd(this.firestore,ef(this._delegate,t))}catch(t){throw xd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(E.h)(t))instanceof Jl&&rf(this._delegate,t)},t.prototype.set=function(t,e){e=Kl("DocumentReference.set",e);try{return function(t,e,n){t=Wl(t,Jl);var r=Wl(t.firestore,uf),i=ld(t.converter,e,n);return vd(r,[Of(Ef(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Po.none())])}(this._delegate,t,e)}catch(t){throw xd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?gd(this._delegate,t):gd.apply(void 0,Object(I.f)([this._delegate,t,e],n))}catch(t){throw xd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return vd(Wl((t=this._delegate).firestore,uf),[new $o(t._key,Po.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=jd(e),i=Cd(e,function(e){return new Rd(t.firestore,new Hf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return md(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Wl(t,Jl);var e=Wl(t.firestore,uf),n=cf(e),r=new yd(e);return function(t,e){var n=this,r=new ka;return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(n,void 0,void 0,function(){var n;return Object(I.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i;return Object(I.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Gr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Ur(Rr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=mh(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Dl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new Hf(e,r,t._key,n,new Qf(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Wl(t,Jl);var e=Wl(t.firestore,uf);return xl(cf(e),t._key,{source:"server"}).then(function(n){return bd(e,t,n)})}(this._delegate):function(t){t=Wl(t,Jl);var e=Wl(t.firestore,uf);return xl(cf(e),t._key).then(function(n){return bd(e,t,n)})}(this._delegate)).then(function(t){return new Rd(e.firestore,new Hf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Ad.nu(this.firestore,e):null))},t}();function xd(t,e,n){return t.message=t.message.replace(e,n),t}function jd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!af(r))return r}return{}}function Cd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=af(t[0])?t[0]:af(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Rd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Nd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return $f(this._delegate,t._delegate)},t}(),Ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(I.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Rd),Pd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Sd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,td(this._delegate,function(t,e,n){var r=e,i=zf("where",t);return new ed(i,r,n)}(e,n,r)))}catch(e){throw xd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,td(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=zf("orderBy",t);return new nd(r,n)}(e,n)))}catch(e){throw xd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,td(this._delegate,function(t){return Yl("limit",t),new rd("limit",t,"F")}(e)))}catch(e){throw xd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,td(this._delegate,function(t){return Yl("limitToLast",t),new rd("limitToLast",t,"L")}(e)))}catch(e){throw xd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new id("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw xd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new id("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw xd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new od("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw xd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new od("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw xd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return of(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Wl(t,Zl);var e=Wl(t.firestore,uf),n=cf(e),r=new yd(e);return function(t,e){var n=this,r=new ka;return t.asyncQueue.enqueueAndForget(function(){return Object(I.b)(n,void 0,void 0,function(){var n;return Object(I.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(I.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(I.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,rc(t,e,!0)];case 1:return a=u.sent(),r=new Ch(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=mh(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Dl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new Yf(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Wl(t,Zl);var e=Wl(t.firestore,uf),n=cf(e),r=new yd(e);return jl(n,t._query,{source:"server"}).then(function(n){return new Yf(e,r,t,n)})}(this._delegate):function(t){t=Wl(t,Zl);var e=Wl(t.firestore,uf),n=cf(e),r=new yd(e);return Jf(t._query),jl(n,t._query).then(function(n){return new Yf(e,r,t,n)})}(this._delegate)).then(function(t){return new Md(e.firestore,new Yf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=jd(e),i=Cd(e,function(e){return new Md(t.firestore,new Yf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return md(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Ad.nu(this.firestore,e):null))},t}(),Ld=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Ud(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Md=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Pd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new Ud(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new Ld(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new Ud(n._firestore,r))})},t.prototype.isEqual=function(t){return $f(this._delegate,t._delegate)},t}(),Fd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(I.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Nd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Nd(this.firestore,void 0===t?nf(this._delegate):nf(this._delegate,t))}catch(t){throw xd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Wl(t.firestore,uf),r=nf(t),i=ld(t.converter,e);return vd(n,[Of(Ef(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Po.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Nd(e.firestore,t)})},e.prototype.isEqual=function(t){return rf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?Ad.nu(this.firestore,t):null))},e}(Pd);function Vd(t){return Wl(t,Jl)}var qd,Bd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(df.bind.apply(df,Object(I.f)([void 0],t)))}return t.documentId=function(){return new t(ii.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(E.h)(t))instanceof df&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Kd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Df("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new _f("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Af("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Nf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Gd=n("/6Yf"),zd={Firestore:_d,GeoPoint:gf,Timestamp:Xr,Blob:Ed,Transaction:Dd,WriteBatch:kd,DocumentReference:Nd,DocumentSnapshot:Rd,Query:Pd,QueryDocumentSnapshot:Ud,QuerySnapshot:Md,CollectionReference:Fd,FieldPath:Bd,FieldValue:Kd,setLogLevel:function(t){Pr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Qd(t,e){return function(t,e=u.b){return new c.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function Hd(t,e){return Qd(t,e).pipe(Object(p.a)(t=>({payload:t,type:"query"})))}function Wd(t,e){return Hd(t,e).pipe(Object(f.a)(void 0),Object(d.a)(),Object(p.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function Yd(t,e,n){return Wd(t,n).pipe(Object(y.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return Xd(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return Xd(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Xd(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(g.a)(),Object(p.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function Xd(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function $d(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}(function(t,e){t.INTERNAL.registerComponent(new Gd.a("firestore",function(t){return function(t,e){return new _d(t,new uf(t,e),new Od)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},zd)))})(qd=T.a),qd.registerVersion("@firebase/firestore","2.3.10");class Jd{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=Wd(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(p.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(f.a)(void 0),Object(d.a)(),Object(m.a)(([t,e])=>e.length>0||!t),Object(p.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(y.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=$d(t);return Yd(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Hd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(h.a)(this.query.get(t)).pipe(Object(v.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new Zd(this.ref.doc(t),this.afs)}}class Zd{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=op(n,e);return new Jd(r,i,this.afs)}snapshotChanges(){return Qd(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(f.a)(void 0),Object(d.a)(),Object(p.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(p.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(h.a)(this.ref.get(t)).pipe(Object(v.b)(this.afs.schedulers.insideAngular))}}class tp{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Wd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(m.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Wd(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(y.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=$d(t);return Yd(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Hd(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(h.a)(this.query.get(t)).pipe(Object(v.b)(this.afs.schedulers.insideAngular))}}const ep=new i.s("angularfire2.enableFirestorePersistence"),np=new i.s("angularfire2.firestore.persistenceSettings"),rp=new i.s("angularfire2.firestore.settings"),ip=new i.s("angularfire2.firestore.use-emulator");function op(t,e=(t=>t)){return{query:e(t),ref:t}}let sp=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new b.d(s),this.keepUnstableUntilFirst=Object(b.h)(this.schedulers);const f=Object(b.g)(t,s,e);!w.a.auth&&c&&Object(b.j)();const d=u;[this.firestore,this.persistenceEnabled$]=Object(b.f)(`${f.name}.firestore`,"AngularFirestore",f,()=>{const t=s.runOutsideAngular(()=>f.firestore());if(i&&t.settings(i),d&&t.useEmulator(...d),n&&!Object(r.u)(o)){const e=()=>{try{return Object(h.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(qd){return"undefined"!=typeof console&&console.warn(qd),Object(l.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(l.a)(!1)]},[i,d,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=op(n,e),o=this.schedulers.ngZone.run(()=>r);return new Jd(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new tp(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new Zd(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Yb(b.c),i.Yb(b.b,8),i.Yb(ep,8),i.Yb(rp,8),i.Yb(i.D),i.Yb(i.B),i.Yb(np,8),i.Yb(ip,8),i.Yb(a.b,8))},t.\u0275prov=i.Kb({factory:function(){return new t(i.Yb(b.c),i.Yb(b.b,8),i.Yb(ep,8),i.Yb(rp,8),i.Yb(i.D),i.Yb(i.B),i.Yb(np,8),i.Yb(ip,8),i.Yb(a.b,8))},token:t,providedIn:"any"}),t})();var ap=n("/t3+"),up=n("bTqV"),cp=n("NFeN"),hp=n("STbY"),lp=n("XhcP"),fp=n("MutI"),dp=n("FKr1");let pp=(()=>{class t{constructor(t,e,n,r){this.api=t,this.router=e,this.auth=n,this.db=r,this.user={},this.mode="side",this.menu=[{name:"Dashboard",icon:"dashboard",url:"/admin/dashboard"},{group:"Menu Group",children:[{name:"Image Gallery",icon:"images",url:"/admin/gallery"}]}]}ngOnInit(){}logout(){return this.auth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["/login"])})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(o.a),i.Ob(s.a),i.Ob(a.a),i.Ob(sp))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-admin"]],decls:46,vars:9,consts:[[1,"example-header",2,"background-color","chocolate"],["mat-icon-button","",3,"click"],[1,"uk-width-expand"],["appMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-button","",3,"matMenuTriggerFor"],[1,"example-container"],["mode","side","opened","",1,"sidenav-left",2,"background-color","coral",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],["routerLink","/admin/dashboard"],["matListIcon",""],["matLine",""],["routerLink","/admin/product"],["routerLink","/admin/barang"],["routerLink","/admin/tentang"],["mode","side",1,"example-container",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],[2,"padding","20px","background-color","#ccc"]],template:function(t,e){if(1&t){const t=i.Vb();i.Sb(0),i.Ub(1,"mat-toolbar",0),i.Ub(2,"button",1),i.bc("click",function(){return i.rc(t),i.pc(17).toggle()}),i.Ub(3,"mat-icon"),i.yc(4,"menu"),i.Tb(),i.Tb(),i.Ub(5,"span"),i.yc(6,"Persedian Barang"),i.Tb(),i.Pb(7,"div",2),i.Ub(8,"mat-menu",null,3),i.Ub(10,"button",4),i.bc("click",function(){return e.logout()}),i.yc(11,"Logout"),i.Tb(),i.Tb(),i.Ub(12,"button",5),i.Ub(13,"mat-icon"),i.yc(14,"account_circle"),i.Tb(),i.Tb(),i.Tb(),i.Ub(15,"mat-sidenav-container",6),i.Ub(16,"mat-sidenav",7,8),i.Ub(18,"mat-nav-list"),i.Ub(19,"mat-list-item",9),i.Ub(20,"mat-icon",10),i.yc(21,"dashboard"),i.Tb(),i.Ub(22,"h3",11),i.yc(23,"Dashboard"),i.Tb(),i.Tb(),i.Tb(),i.Ub(24,"mat-nav-list"),i.Ub(25,"mat-list-item",12),i.Ub(26,"mat-icon",10),i.yc(27,"table_view"),i.Tb(),i.Ub(28,"h3",11),i.yc(29,"Barang Masuk"),i.Tb(),i.Tb(),i.Tb(),i.Ub(30,"mat-nav-list"),i.Ub(31,"mat-list-item",13),i.Ub(32,"mat-icon",10),i.yc(33,"table_view"),i.Tb(),i.Ub(34,"h3",11),i.yc(35,"Barang Keluar"),i.Tb(),i.Tb(),i.Tb(),i.Ub(36,"mat-nav-list"),i.Ub(37,"mat-list-item",14),i.Ub(38,"mat-icon",10),i.yc(39,"info"),i.Tb(),i.Ub(40,"h3",11),i.yc(41,"Tentang"),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Pb(42,"mat-sidenav",15,8),i.Ub(44,"mat-sidenav-content",16),i.Pb(45,"router-outlet"),i.Tb(),i.Tb(),i.Rb()}if(2&t){const t=i.pc(9);i.Db(12),i.kc("matMenuTriggerFor",t),i.Db(4),i.kc("position","start")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0),i.Db(26),i.kc("position","end")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0)}},directives:[ap.a,up.a,cp.a,hp.a,hp.b,hp.d,lp.b,lp.a,fp.f,fp.c,s.b,fp.b,dp.j,lp.c,s.d],styles:[".example-container[_ngcontent-%COMP%]{position:absolute;top:60px;bottom:0;left:0;right:0}.example-sidenav[_ngcontent-%COMP%]{width:400px}.example-sidenav[_ngcontent-%COMP%], .sidenav-left[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.sidenav-left[_ngcontent-%COMP%]{width:250px}"]}),t})(),yp=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ib({type:t,selectors:[["app-dashboard"]],decls:1,vars:0,consts:[[1,"uk-flex","uk-flex-middle","uk-flex-center","uk-height-viewport","uk-animation-toggle","uk-animation-fade",2,"background-image","url('assets/gudang.jpg')","background-size","cover","background-position","center"]],template:function(t,e){1&t&&i.Pb(0,"div",0)},styles:[""]}),t})();var gp=n("w55g"),mp=n("0IaG"),vp=n("kmnG"),bp=n("qFsG"),wp=n("3Pt+");let Tp=(()=>{class t{constructor(t,e,n,r,i){this.dialogRef=t,this.data=e,this.api=n,this.db=r,this.auth=i,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("books").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("books").doc(this.data.id).update(this.data).then(t=>{this.data.uid=this.userData.uid,this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(mp.g),i.Ob(mp.a),i.Ob(o.a),i.Ob(sp),i.Ob(a.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-product-detail"]],decls:32,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",2,"background-color","blue",3,"disabled","click"]],template:function(t,e){1&t&&(i.Ub(0,"h3",0),i.yc(1," Detail Barang\n"),i.Tb(),i.Ub(2,"div",1),i.Ub(3,"mat-form-field",2),i.Ub(4,"mat-label"),i.yc(5,"NAMA BARANG"),i.Tb(),i.Ub(6,"input",3),i.bc("ngModelChange",function(t){return e.data.title=t}),i.Tb(),i.Tb(),i.Ub(7,"mat-form-field",2),i.Ub(8,"mat-label"),i.yc(9,"TANGGAL MASUK"),i.Tb(),i.Ub(10,"input",3),i.bc("ngModelChange",function(t){return e.data.author=t}),i.Tb(),i.Tb(),i.Ub(11,"mat-form-field",2),i.Ub(12,"mat-label"),i.yc(13,"HARGA"),i.Tb(),i.Ub(14,"input",3),i.bc("ngModelChange",function(t){return e.data.publisher=t}),i.Tb(),i.Tb(),i.Ub(15,"mat-form-field",2),i.Ub(16,"mat-label"),i.yc(17,"JUMLAH MASUK"),i.Tb(),i.Ub(18,"input",3),i.bc("ngModelChange",function(t){return e.data.in=t}),i.Tb(),i.Tb(),i.Ub(19,"mat-form-field",2),i.Ub(20,"mat-label"),i.yc(21,"JUMLAH KELUAR"),i.Tb(),i.Ub(22,"input",3),i.bc("ngModelChange",function(t){return e.data.out=t}),i.Tb(),i.Tb(),i.Ub(23,"mat-form-field",2),i.Ub(24,"mat-label"),i.yc(25,"SISA"),i.Tb(),i.Ub(26,"input",3),i.bc("ngModelChange",function(t){return e.data.ready=t}),i.Tb(),i.Tb(),i.Tb(),i.Ub(27,"div",4),i.Ub(28,"button",5),i.yc(29,"Batal"),i.Tb(),i.Ub(30,"button",6),i.bc("click",function(){return e.saveData()}),i.yc(31),i.Tb(),i.Tb()),2&t&&(i.Db(6),i.kc("ngModel",e.data.title),i.Db(4),i.kc("ngModel",e.data.author),i.Db(4),i.kc("ngModel",e.data.publisher),i.Db(4),i.kc("ngModel",e.data.in),i.Db(4),i.kc("ngModel",e.data.out),i.Db(4),i.kc("ngModel",e.data.ready),i.Db(4),i.kc("disabled",e.loading),i.Db(1),i.zc(e.loading?"Menyimpan..":"Simpan"))},directives:[mp.h,mp.e,vp.b,vp.e,bp.b,wp.c,wp.j,wp.l,mp.c,up.a,mp.d],styles:[""]}),t})();var Ip=n("f0Cb");let Ep=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={},this.user={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(mp.g),i.Ob(mp.a),i.Ob(sp),i.Ob(a.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-tampilmasuk"]],decls:40,vars:4,consts:[["mat-dialog-content",""],["matSubheader",""],["matListIcon",""],["matLine",""],["mat-line",""],[1,"spacer"],["mat-button","","mat-dialog-close",""]],template:function(t,e){1&t&&(i.Ub(0,"div",0),i.Ub(1,"mat-list"),i.Ub(2,"h3",1),i.yc(3,"Detail Alamat"),i.Tb(),i.Ub(4,"mat-list-item"),i.Ub(5,"mat-icon",2),i.yc(6,"person"),i.Tb(),i.Ub(7,"p",3),i.yc(8,"Nama Barang"),i.Tb(),i.Ub(9,"h3",4),i.yc(10),i.Tb(),i.Pb(11,"mat-divider"),i.Tb(),i.Ub(12,"mat-list-item"),i.Ub(13,"mat-icon",2),i.yc(14,"local_hotel"),i.Tb(),i.Ub(15,"p",3),i.yc(16,"Tanggal"),i.Tb(),i.Ub(17,"h3",4),i.yc(18),i.Tb(),i.Pb(19,"mat-divider"),i.Tb(),i.Ub(20,"mat-list-item"),i.Ub(21,"mat-icon",2),i.yc(22,"home"),i.Tb(),i.Ub(23,"p",3),i.yc(24,"Harga"),i.Tb(),i.Ub(25,"h3",4),i.yc(26),i.Tb(),i.Pb(27,"mat-divider"),i.Tb(),i.Ub(28,"mat-list-item"),i.Ub(29,"mat-icon",2),i.yc(30,"home"),i.Tb(),i.Ub(31,"p",3),i.yc(32,"Jumlah Masuk"),i.Tb(),i.Ub(33,"h3",4),i.yc(34),i.Tb(),i.Pb(35,"mat-divider"),i.Tb(),i.Tb(),i.Tb(),i.Ub(36,"mat-dialog-actions"),i.Pb(37,"span",5),i.Ub(38,"button",6),i.yc(39,"Tutup"),i.Tb(),i.Tb()),2&t&&(i.Db(10),i.zc(e.data.title),i.Db(8),i.zc(e.data.author),i.Db(8),i.zc(e.data.publisher),i.Db(8),i.zc(e.data.in))},directives:[mp.e,fp.a,fp.e,fp.c,cp.a,fp.b,dp.j,Ip.a,mp.c,up.a,mp.d],styles:[""]}),t})();var Op=n("Xa2L"),_p=n("Wp6s");function Sp(t,e){1&t&&(i.Ub(0,"div",2),i.Pb(1,"mat-spinner"),i.Tb())}function Dp(t,e){if(1&t){const t=i.Vb();i.Ub(0,"tr"),i.Ub(1,"td"),i.Ub(2,"button",9),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).detailItem(n,r)}),i.Ub(3,"mat-icon"),i.yc(4,"remove_red_eye"),i.Tb(),i.Tb(),i.Tb(),i.Ub(5,"td"),i.yc(6),i.Tb(),i.Ub(7,"td"),i.yc(8),i.Tb(),i.Ub(9,"td"),i.yc(10),i.Tb(),i.Ub(11,"td"),i.yc(12),i.Tb(),i.Ub(13,"td"),i.yc(14),i.Tb(),i.Ub(15,"td",7),i.Ub(16,"button",10),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).productDetail(n,r)}),i.yc(17,"Edit"),i.Tb(),i.Ub(18,"button",11),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).deleteProduct(n.id,r)}),i.yc(19),i.Tb(),i.Tb(),i.Tb()}if(2&t){const t=e.$implicit,n=e.index,r=i.fc(2);i.Db(6),i.zc(n+1),i.Db(2),i.zc(t.title),i.Db(2),i.zc(t.author),i.Db(2),i.zc(t.publisher),i.Db(2),i.zc(t.in),i.Db(4),i.kc("disabled",r.loadingDelete[n]),i.Db(1),i.zc(r.loadingDelete[n]?"Deleting..":"Delete")}}function kp(t,e){if(1&t){const t=i.Vb();i.Ub(0,"mat-card"),i.Ub(1,"mat-card-header"),i.Ub(2,"mat-card-title"),i.yc(3,"BARANG MASUK"),i.Tb(),i.Tb(),i.Ub(4,"mat-card-content"),i.Ub(5,"div",3),i.Pb(6,"span",4),i.Ub(7,"button",5),i.bc("click",function(){return i.rc(t),i.fc().productDetail({},-1)}),i.yc(8,"Tambah"),i.Tb(),i.Tb(),i.Ub(9,"table",6),i.Ub(10,"thead"),i.Pb(11,"th"),i.Ub(12,"th"),i.yc(13,"NO"),i.Tb(),i.Ub(14,"th"),i.yc(15,"NAMA BARANG"),i.Tb(),i.Ub(16,"th"),i.yc(17,"TANGGAL"),i.Tb(),i.Ub(18,"th"),i.yc(19,"HARGA"),i.Tb(),i.Ub(20,"th"),i.yc(21,"JUMLAH MASUK"),i.Tb(),i.Pb(22,"th",7),i.Tb(),i.Ub(23,"tbody"),i.xc(24,Dp,20,7,"tr",8),i.Tb(),i.Tb(),i.Tb(),i.Tb()}if(2&t){const t=i.fc();i.Db(24),i.kc("ngForOf",t.books)}}let Ap=(()=>{class t{constructor(t,e,n,r){this.dialog=t,this.api=e,this.db=n,this.auth=r,this.books=[],this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Product",this.auth.user.subscribe(t=>{this.userData=t,this.getBooks()})}getBooks(){this.loading=!0,this.db.collection("books",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.books=t,this.loading=!1},t=>{this.loading=!1})}detailItem(t,e){this.dialog.open(Ep,{width:"450px",data:t}).afterClosed().subscribe(t=>{console.log("card ditutup")})}productDetail(t,e){this.dialog.open(Tp,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}deleteProduct(t,e){confirm("Delete Item?")&&this.db.collection("books").doc(t).delete().then(t=>{this.books.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(mp.b),i.Ob(o.a),i.Ob(sp),i.Ob(a.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-product"]],decls:2,vars:2,consts:[["style","height: 300px","class","uk-flex uk-flex-center uk-flex-middle",4,"ngIf"],[4,"ngIf"],[1,"uk-flex","uk-flex-center","uk-flex-middle",2,"height","300px"],[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","",2,"background-color","blue",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-icon-button","",3,"click"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.xc(0,Sp,2,0,"div",0),i.xc(1,kp,25,1,"mat-card",1)),2&t&&(i.kc("ngIf",e.loading),i.Db(1),i.kc("ngIf",!e.loading))},directives:[r.k,Op.b,_p.a,_p.c,_p.e,_p.b,up.a,r.j,cp.a],styles:[""]}),t})(),Np=(()=>{class t{constructor(t,e,n,r,i){this.dialogRef=t,this.data=e,this.api=n,this.db=r,this.auth=i,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("books").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("books").doc(this.data.id).update(this.data).then(t=>{this.data.uid=this.userData.uid,this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(mp.g),i.Ob(mp.a),i.Ob(o.a),i.Ob(sp),i.Ob(a.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-barang-detail"]],decls:28,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Ub(0,"h3",0),i.yc(1," Detail Barang\n"),i.Tb(),i.Ub(2,"div",1),i.Ub(3,"mat-form-field",2),i.Ub(4,"mat-label"),i.yc(5,"NAMA"),i.Tb(),i.Ub(6,"input",3),i.bc("ngModelChange",function(t){return e.data.title=t}),i.Tb(),i.Tb(),i.Ub(7,"mat-form-field",2),i.Ub(8,"mat-label"),i.yc(9,"JUMLAH"),i.Tb(),i.Ub(10,"input",3),i.bc("ngModelChange",function(t){return e.data.author=t}),i.Tb(),i.Tb(),i.Ub(11,"mat-form-field",2),i.Ub(12,"mat-label"),i.yc(13,"HARGA"),i.Tb(),i.Ub(14,"input",3),i.bc("ngModelChange",function(t){return e.data.publisher=t}),i.Tb(),i.Tb(),i.Ub(15,"mat-form-field",2),i.Ub(16,"mat-label"),i.yc(17,"JUMLAH KELUAR"),i.Tb(),i.Ub(18,"input",3),i.bc("ngModelChange",function(t){return e.data.out=t}),i.Tb(),i.Tb(),i.Ub(19,"mat-form-field",2),i.Ub(20,"mat-label"),i.yc(21,"SISA"),i.Tb(),i.Ub(22,"input",3),i.bc("ngModelChange",function(t){return e.data.ready=t}),i.Tb(),i.Tb(),i.Tb(),i.Ub(23,"div",4),i.Ub(24,"button",5),i.yc(25,"Batal"),i.Tb(),i.Ub(26,"button",6),i.bc("click",function(){return e.saveData()}),i.yc(27),i.Tb(),i.Tb()),2&t&&(i.Db(6),i.kc("ngModel",e.data.title),i.Db(4),i.kc("ngModel",e.data.author),i.Db(4),i.kc("ngModel",e.data.publisher),i.Db(4),i.kc("ngModel",e.data.out),i.Db(4),i.kc("ngModel",e.data.ready),i.Db(4),i.kc("disabled",e.loading),i.Db(1),i.zc(e.loading?"Menyimpan..":"Simpan"))},directives:[mp.h,mp.e,vp.b,vp.e,bp.b,wp.c,wp.j,wp.l,mp.c,up.a,mp.d],styles:[""]}),t})(),xp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={},this.user={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(mp.g),i.Ob(mp.a),i.Ob(sp),i.Ob(a.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-tampilkeluar"]],decls:48,vars:5,consts:[["mat-dialog-content",""],["matSubheader",""],["matListIcon",""],["matLine",""],["mat-line",""],[1,"spacer"],["mat-button","","mat-dialog-close",""]],template:function(t,e){1&t&&(i.Ub(0,"div",0),i.Ub(1,"mat-list"),i.Ub(2,"h3",1),i.yc(3,"Detail Alamat"),i.Tb(),i.Ub(4,"mat-list-item"),i.Ub(5,"mat-icon",2),i.yc(6,"person"),i.Tb(),i.Ub(7,"p",3),i.yc(8,"Nama Barang"),i.Tb(),i.Ub(9,"h3",4),i.yc(10),i.Tb(),i.Pb(11,"mat-divider"),i.Tb(),i.Ub(12,"mat-list-item"),i.Ub(13,"mat-icon",2),i.yc(14,"local_hotel"),i.Tb(),i.Ub(15,"p",3),i.yc(16,"Tanggal"),i.Tb(),i.Ub(17,"h3",4),i.yc(18),i.Tb(),i.Pb(19,"mat-divider"),i.Tb(),i.Ub(20,"mat-list-item"),i.Ub(21,"mat-icon",2),i.yc(22,"home"),i.Tb(),i.Ub(23,"p",3),i.yc(24,"Harga"),i.Tb(),i.Ub(25,"h3",4),i.yc(26),i.Tb(),i.Pb(27,"mat-divider"),i.Tb(),i.Ub(28,"mat-list-item"),i.Ub(29,"mat-icon",2),i.yc(30,"home"),i.Tb(),i.Ub(31,"p",3),i.yc(32,"Jumlah Keluar"),i.Tb(),i.Ub(33,"h3",4),i.yc(34),i.Tb(),i.Pb(35,"mat-divider"),i.Tb(),i.Ub(36,"mat-list-item"),i.Ub(37,"mat-icon",2),i.yc(38,"home"),i.Tb(),i.Ub(39,"p",3),i.yc(40,"Sisa"),i.Tb(),i.Ub(41,"h3",4),i.yc(42),i.Tb(),i.Pb(43,"mat-divider"),i.Tb(),i.Tb(),i.Tb(),i.Ub(44,"mat-dialog-actions"),i.Pb(45,"span",5),i.Ub(46,"button",6),i.yc(47,"Tutup"),i.Tb(),i.Tb()),2&t&&(i.Db(10),i.zc(e.data.title),i.Db(8),i.zc(e.data.author),i.Db(8),i.zc(e.data.publisher),i.Db(8),i.zc(e.data.out),i.Db(8),i.zc(e.data.ready))},directives:[mp.e,fp.a,fp.e,fp.c,cp.a,fp.b,dp.j,Ip.a,mp.c,up.a,mp.d],styles:[""]}),t})();function jp(t,e){1&t&&(i.Ub(0,"div",2),i.Pb(1,"mat-spinner"),i.Tb())}function Cp(t,e){if(1&t){const t=i.Vb();i.Ub(0,"tr"),i.Ub(1,"td"),i.Ub(2,"button",6),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).detailItem(n,r)}),i.Ub(3,"mat-icon"),i.yc(4,"remove_red_eye"),i.Tb(),i.Tb(),i.Tb(),i.Ub(5,"td"),i.yc(6),i.Tb(),i.Ub(7,"td"),i.yc(8),i.Tb(),i.Ub(9,"td"),i.yc(10),i.Tb(),i.Ub(11,"td"),i.yc(12),i.Tb(),i.Ub(13,"td"),i.yc(14),i.Tb(),i.Ub(15,"td"),i.yc(16),i.Tb(),i.Ub(17,"td",4),i.Ub(18,"button",7),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).productDetail(n,r)}),i.yc(19,"Edit"),i.Tb(),i.Ub(20,"button",8),i.bc("click",function(){i.rc(t);const n=e.$implicit,r=e.index;return i.fc(2).deleteProduct(n.id,r)}),i.yc(21),i.Tb(),i.Tb(),i.Tb()}if(2&t){const t=e.$implicit,n=e.index,r=i.fc(2);i.Db(6),i.zc(n+1),i.Db(2),i.zc(t.title),i.Db(2),i.zc(t.author),i.Db(2),i.zc(t.publisher),i.Db(2),i.zc(t.out),i.Db(2),i.zc(t.ready),i.Db(4),i.kc("disabled",r.loadingDelete[n]),i.Db(1),i.zc(r.loadingDelete[n]?"Deleting..":"Delete")}}function Rp(t,e){if(1&t&&(i.Ub(0,"mat-card"),i.Ub(1,"mat-card-header"),i.Ub(2,"mat-card-title"),i.yc(3,"BARANG KELUAR"),i.Tb(),i.Tb(),i.Ub(4,"mat-card-content"),i.Ub(5,"table",3),i.Ub(6,"thead"),i.Pb(7,"th"),i.Ub(8,"th"),i.yc(9,"NO"),i.Tb(),i.Ub(10,"th"),i.yc(11,"NAMA BARANG"),i.Tb(),i.Ub(12,"th"),i.yc(13,"TANGGAL"),i.Tb(),i.Ub(14,"th"),i.yc(15,"HARGA"),i.Tb(),i.Ub(16,"th"),i.yc(17,"JUMLAH KELUAR"),i.Tb(),i.Ub(18,"th"),i.yc(19,"SISA"),i.Tb(),i.Pb(20,"th",4),i.Tb(),i.Ub(21,"tbody"),i.xc(22,Cp,22,8,"tr",5),i.Tb(),i.Tb(),i.Tb(),i.Tb()),2&t){const t=i.fc();i.Db(22),i.kc("ngForOf",t.book)}}const Up=[{path:"",component:pp,children:[{path:"dashboard",component:yp},{path:"barang",component:(()=>{class t{constructor(t,e,n,r){this.dialog=t,this.api=e,this.db=n,this.auth=r,this.book=[],this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Barang",this.auth.user.subscribe(t=>{this.userData=t,this.getBook()})}getBook(){this.loading=!0,this.db.collection("books",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.book=t,this.loading=!1},t=>{this.loading=!1})}detailItem(t,e){this.dialog.open(xp,{width:"450px",data:t}).afterClosed().subscribe(t=>{console.log("card ditutup")})}productDetail(t,e){this.dialog.open(Np,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}deleteProduct(t,e){confirm("Delete Item?")&&this.db.collection("book").doc(t).delete().then(t=>{this.book.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(mp.b),i.Ob(o.a),i.Ob(sp),i.Ob(a.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-barang"]],decls:2,vars:2,consts:[["style","height: 300px","class","uk-flex uk-flex-center uk-flex-middle",4,"ngIf"],[4,"ngIf"],[1,"uk-flex","uk-flex-center","uk-flex-middle",2,"height","300px"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-icon-button","",3,"click"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.xc(0,jp,2,0,"div",0),i.xc(1,Rp,23,1,"mat-card",1)),2&t&&(i.kc("ngIf",e.loading),i.Db(1),i.kc("ngIf",!e.loading))},directives:[r.k,Op.b,_p.a,_p.c,_p.e,_p.b,r.j,up.a,cp.a],styles:[""]}),t})()},{path:"product",component:Ap},{path:"tentang",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ib({type:t,selectors:[["app-tentang"]],decls:11,vars:0,consts:[[1,"uk-article","uk-card","uk-card-default","uk-card-body","uk-animation-toggle","uk-animation-fade","uk-margin-large-top"],[1,"uk-article-title"],["href","",1,"uk-link-reset"],["uk-grid","",1,"uk-grid-small","uk-child-width-auto"]],template:function(t,e){1&t&&(i.Ub(0,"article",0),i.Ub(1,"h1",1),i.Ub(2,"a",2),i.Ub(3,"b"),i.yc(4,"Buku Data Barang Masuk Dan Keluar"),i.Tb(),i.Tb(),i.Tb(),i.Ub(5,"div",3),i.Ub(6,"table"),i.Ub(7,"tr"),i.Ub(8,"td"),i.yc(9,"Aplikasi Web Ini Di buat untuk perhitungan persedian stok barang digudang"),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Tb(),i.Pb(10,"router-outlet"))},directives:[s.d],styles:[""]}),t})()},{path:"",pathMatch:"full",redirectTo:"/admin/dashboard"}]}];let Pp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Mb({type:t}),t.\u0275inj=i.Lb({imports:[[r.c,s.c.forChild(Up),gp.a,wp.f]]}),t})()}}]);